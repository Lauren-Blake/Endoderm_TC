<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Lauren Blake" />


<title>Explore_temporal_changes_in_variation</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">

/* padding for bootstrap navbar */
body {
  padding-top: 50px;
  padding-bottom: 40px;
}


/* offset scroll position for anchor links (for fixed navbar)  */
.section h2 {
  padding-top: 55px;
  margin-top: -55px;
}
.section h3 {
  padding-top: 55px;
  margin-top: -55px;
}



/* don't use link color in navbar */
.dropdown-menu>li>a {
  color: black;
}

/* some padding for disqus */
#disqus_thread {
  margin-top: 45px;
}

</style>

<link rel="stylesheet" href="libs/font-awesome-4.1.0/css/font-awesome.min.css"/>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Endoderm_TimeCourse</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="license.html">License</a></li>
        <li><a href="https://github.com/Lauren-Blake/Endoderm_TC">GitHub</a></li>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Explore_temporal_changes_in_variation</h1>
<h4 class="author"><em>Lauren Blake</em></h4>
<h4 class="date"><em>January 9, 2017</em></h4>

</div>

<div id="TOC">
<ul>
<li><a href="#check-data">Check data</a></li>
<li><a href="#examine-the-means-and-the-variances-between-day-species-pairs">Examine the means and the variances between day-species pairs</a></li>
<li><a href="#evaluating-global-changes-in-variation">Evaluating global changes in variation</a><ul>
<li><a href="#no-global-reduction-in-means-between-day-0-and-day-1">No global reduction in means between day 0 and day 1</a></li>
<li><a href="#no-global-reduction-in-variance-between-day-0-and-1-in-both-species">No global reduction in variance between day 0 and 1 in both species</a></li>
</ul></li>
<li><a href="#characterizing-variance-trends-between-days">Characterizing variance trends between days</a><ul>
<li><a href="#which-individual-genes-undergo-an-increase-or-reduction-in-variation-in-one-species-given-an-increase-or-reduction-in-variation-in-the-other-species">Which individual genes undergo an increase or reduction in variation in one species given an increase or reduction in variation in the other species?</a><ul>
<li><a href="#general-functions-for-reductionincrease-in-variance">General functions for reduction/increase in variance</a></li>
<li><a href="#enrichment-in-chimps">Enrichment in chimps</a></li>
<li><a href="#estimates-of-pi0-and-pi1">Estimates of pi0 and pi1</a></li>
<li><a href="#sharing-estimates-chimps-conditioned-on-humans">Sharing estimates (chimps conditioned on humans)</a></li>
<li><a href="#enrichments-in-humans">Enrichments in humans</a></li>
<li><a href="#sharing-estimates-humans-conditioned-on-chimps">Sharing estimates (humans conditioned on chimps)</a></li>
<li><a href="#for-bryan-to-test-clusters">For Bryan to test clusters</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<p>The goal of this script is to assess the extent of regulatory variation in our cell types.</p>
<div id="check-data" class="section level2">
<h2>Check data</h2>
<pre class="r"><code># Load libraries

library(&quot;ggplot2&quot;)</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.2.4</code></pre>
<pre class="r"><code>library(&quot;qvalue&quot;)</code></pre>
<pre><code>## Warning: package &#39;qvalue&#39; was built under R version 3.2.3</code></pre>
<pre class="r"><code>source(&quot;~/Desktop/Endoderm_TC/ashlar-trial/analysis/chunk-options.R&quot;)</code></pre>
<pre><code>## Warning: package &#39;knitr&#39; was built under R version 3.2.5</code></pre>
<pre class="r"><code>library(&quot;RColorBrewer&quot;)

# Load colors
pal &lt;- c(brewer.pal(9, &quot;Set1&quot;), brewer.pal(8, &quot;Set2&quot;), brewer.pal(12, &quot;Set3&quot;))


# Load data
cpm_in_cutoff &lt;- read.delim(&quot;~/Desktop/Endoderm_TC/ashlar-trial/data/cpm_norm_data.txt&quot;)</code></pre>
<pre class="r"><code># Take the mean of the technical replicates when available

  # Day 0 technical replicates
D0_28815 &lt;- as.data.frame(apply(cpm_in_cutoff[,5:6], 1, mean))
D0_3647 &lt;- as.data.frame(apply(cpm_in_cutoff[,8:9], 1, mean))
D0_3649 &lt;- as.data.frame(apply(cpm_in_cutoff[,10:11], 1, mean))
D0_40300 &lt;- as.data.frame(apply(cpm_in_cutoff[,12:13], 1, mean))
D0_4955 &lt;- as.data.frame(apply(cpm_in_cutoff[,14:15], 1, mean))
  # Day 1 technical replicates
D1_20157 &lt;- as.data.frame(apply(cpm_in_cutoff[,16:17], 1, mean))
D1_28815 &lt;- as.data.frame(apply(cpm_in_cutoff[,21:22], 1, mean))
D1_3647 &lt;- as.data.frame(apply(cpm_in_cutoff[,24:25], 1, mean))
D1_3649 &lt;- as.data.frame(apply(cpm_in_cutoff[,26:27], 1, mean))
D1_40300 &lt;- as.data.frame(apply(cpm_in_cutoff[,28:29], 1, mean))
D1_4955 &lt;- as.data.frame(apply(cpm_in_cutoff[,30:31], 1, mean))
  # Day 2 technical replicates
D2_20157 &lt;- as.data.frame(apply(cpm_in_cutoff[,32:33], 1, mean))
D2_28815 &lt;- as.data.frame(apply(cpm_in_cutoff[,37:38], 1, mean))
D2_3647 &lt;- as.data.frame(apply(cpm_in_cutoff[,40:41], 1, mean))
D2_3649 &lt;- as.data.frame(apply(cpm_in_cutoff[,42:43], 1, mean))
D2_40300 &lt;- as.data.frame(apply(cpm_in_cutoff[,44:45], 1, mean))
D2_4955 &lt;- as.data.frame(apply(cpm_in_cutoff[,46:47], 1, mean))
  # Day 3 technical replicates
D3_20157 &lt;- as.data.frame(apply(cpm_in_cutoff[,48:49], 1, mean))
D3_28815 &lt;- as.data.frame(apply(cpm_in_cutoff[,53:54], 1, mean))
D3_3647 &lt;- as.data.frame(apply(cpm_in_cutoff[,56:57], 1, mean))
D3_3649 &lt;- as.data.frame(apply(cpm_in_cutoff[,58:59], 1, mean))
D3_40300 &lt;- as.data.frame(apply(cpm_in_cutoff[,60:61], 1, mean))
D3_4955 &lt;- as.data.frame(apply(cpm_in_cutoff[,62:63], 1, mean))

# Create a new data frame with all of the combined technical replicates
mean_tech_reps &lt;- cbind(cpm_in_cutoff[,1:4], D0_28815, cpm_in_cutoff[,7], D0_3647, D0_3649, D0_40300, D0_4955, D1_20157, cpm_in_cutoff[,18:20], D1_28815, cpm_in_cutoff[,23], D1_3647, D1_3649, D1_40300, D1_4955, D2_20157, cpm_in_cutoff[,34:36], D2_28815, cpm_in_cutoff[,39], D2_3647, D2_3649, D2_40300, D2_4955, D3_20157, cpm_in_cutoff[,50:52], D3_28815, cpm_in_cutoff[,55], D3_3647, D3_3649, D3_40300, D3_4955)


colnames(mean_tech_reps) &lt;- c(&quot;D0_20157&quot;, &quot;D0_20961&quot;, &quot;D0_21792&quot;, &quot;D0_28162&quot;, &quot;D0_28815&quot;, &quot;D0_29089&quot;, &quot;D0_3647&quot;, &quot;D0_3649&quot;, &quot;D0_40300&quot;, &quot;D0_4955&quot;, &quot;D1_20157&quot;, &quot;D1_20961&quot;, &quot;D1_21792&quot;, &quot;D1_28162&quot;, &quot;D1_28815&quot;, &quot;D1_29089&quot;, &quot;D1_3647&quot;, &quot;D1_3649&quot;, &quot;D1_40300&quot;, &quot;D1_4955&quot;, &quot;D2_20157&quot;, &quot;D2_20961&quot;, &quot;D2_21792&quot;, &quot;D2_28162&quot;, &quot;D2_28815&quot;, &quot;D2_29089&quot;, &quot;D2_3647&quot;, &quot;D2_3649&quot;, &quot;D2_40300&quot;, &quot;D2_4955&quot;, &quot;D3_20157&quot;, &quot;D3_20961&quot;, &quot;D3_21792&quot;, &quot;D3_28162&quot;, &quot;D3_28815&quot;, &quot;D3_29089&quot;, &quot;D3_3647&quot;, &quot;D3_3649&quot;, &quot;D3_40300&quot;, &quot;D3_4955&quot;)

dim(mean_tech_reps)</code></pre>
<pre><code>[1] 10304    40</code></pre>
<pre class="r"><code># Make a column for which are averaged or not

averaged_status &lt;- c(1,1,1,1,2,1,2,2,2,2,2,1,1,1,2,1,2,2,2,2,2,1,1,1,2,1,2,2,2,2,2,1,1,1,2,1,2,2,2,2)

# Find the technical factors for the biological replicates (no technical replicates)

bio_rep_samplefactors &lt;- read.delim(&quot;~/Downloads/samplefactors-filtered.txt&quot;, stringsAsFactors=FALSE)
day &lt;- bio_rep_samplefactors$Day
species &lt;- bio_rep_samplefactors$Species

# Make PCA plots with the factors colored by day

pca_genes &lt;- prcomp(t(mean_tech_reps), scale = T, retx = TRUE, center = TRUE)

matrixpca &lt;- pca_genes$x
pc1 &lt;- matrixpca[,1]
pc2 &lt;- matrixpca[,2]
pc3 &lt;- matrixpca[,3]
pc4 &lt;- matrixpca[,4]
pc5 &lt;- matrixpca[,5]

pcs &lt;- data.frame(pc1, pc2, pc3, pc4, pc5)

summary &lt;- summary(pca_genes)

#dev.off()

ggplot(data=pcs, aes(x=pc1, y=pc2, color=as.factor(day+1), shape=as.factor(averaged_status), size=2)) + geom_point() + xlab(paste(&quot;PC1 (&quot;,(summary$importance[2,1]*100), &quot;% of variance)&quot;)) + ylab(paste(&quot;PC2 (&quot;,(summary$importance[2,2]*100), &quot;% of variance)&quot;)) + theme_minimal() + guides(color = guide_legend(order=1), size = FALSE, shape = guide_legend(order=3)) + scale_color_discrete(name  =&quot;Day&quot;, labels = c(&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;)) +  scale_shape_manual(values = c(5, 7)) + scale_shape_discrete(name  =&quot;Replicate status&quot;, labels = c(&quot;Single&quot; ,&quot;Averaged&quot;)) + labs(title = &quot;PCs 1 and 2 from global normalized expression&quot;)</code></pre>
<pre><code>Scale for &#39;shape&#39; is already present. Adding another scale for &#39;shape&#39;,
which will replace the existing scale.</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(data=pcs, aes(x=pc1, y=pc2, color=as.factor(day+1), shape=as.factor(averaged_status), size=2)) + geom_point() + xlab(paste(&quot;PC1 (&quot;,(summary$importance[2,1]*100), &quot;% of variance)&quot;)) + ylab(paste(&quot;PC2 (&quot;,(summary$importance[2,2]*100), &quot;% of variance)&quot;)) + scale_shape_manual(values = c(5, 8)) + scale_color_discrete(name  =&quot;Day&quot;, labels = c(&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;))  + labs(title = &quot;PCs 1 and 2 from global normalized gene expression (Averaged bet. technical replicates)&quot;)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-2-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggplotly()</code></pre>
</div>
<div id="examine-the-means-and-the-variances-between-day-species-pairs" class="section level2">
<h2>Examine the means and the variances between day-species pairs</h2>
<pre class="r"><code># Calculate the variance for each species-time pair

humans_day0_var &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,1:6]),1, var) )
colnames(humans_day0_var) &lt;- c(&quot;Variance&quot;) 
chimps_day0_var &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,7:10]),1, var))
colnames(chimps_day0_var) &lt;- c(&quot;Variance&quot;) 
humans_day1_var &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,11:16]),1, var))
colnames(humans_day1_var) &lt;- c(&quot;Variance&quot;) 
chimps_day1_var &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,17:20]),1, var))
colnames(chimps_day1_var) &lt;- c(&quot;Variance&quot;)
humans_day2_var &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,21:26]),1, var))
colnames(humans_day2_var) &lt;- c(&quot;Variance&quot;) 
chimps_day2_var &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,27:30]),1, var))
colnames(chimps_day2_var) &lt;- c(&quot;Variance&quot;)
humans_day3_var &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,31:36]),1, var))
colnames(humans_day3_var) &lt;- c(&quot;Variance&quot;) 
chimps_day3_var &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,37:40]),1, var))
colnames(chimps_day3_var) &lt;- c(&quot;Variance&quot;)

# Calculate the mean for each species-time pair
humans_day0_mean &lt;-  as.data.frame(apply(as.data.frame(mean_tech_reps[,1:6]),1, mean))
colnames(humans_day0_mean) &lt;- c(&quot;Mean&quot;)
chimps_day0_mean &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,7:10]),1, mean))
colnames(chimps_day0_mean) &lt;- c(&quot;Mean&quot;)
humans_day1_mean &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,11:16]),1, mean))
colnames(humans_day1_mean) &lt;- c(&quot;Mean&quot;)
chimps_day1_mean &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,17:20]),1, mean))
colnames(chimps_day1_mean) &lt;- c(&quot;Mean&quot;)
humans_day2_mean &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,21:26]),1, mean))
colnames(humans_day2_mean) &lt;- c(&quot;Mean&quot;)
chimps_day2_mean &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,27:30]),1, mean))
colnames(chimps_day2_mean) &lt;- c(&quot;Mean&quot;)
humans_day3_mean &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,31:36]),1, mean))
colnames(humans_day3_mean) &lt;- c(&quot;Mean&quot;)
chimps_day3_mean &lt;- as.data.frame(apply(as.data.frame(mean_tech_reps[,37:40]),1, mean))
colnames(chimps_day3_mean) &lt;- c(&quot;Mean&quot;)

# Make arrays with all the means

labels1 &lt;- array(&quot;Chimp Day 0&quot;, dim = c(10304, 1)) 
labels2 &lt;- array(&quot;Chimp Day 1&quot;, dim = c(10304, 1)) 
labels3 &lt;- array(&quot;Chimp Day 2&quot;, dim = c(10304, 1)) 
labels4 &lt;- array(&quot;Chimp Day 3&quot;, dim = c(10304, 1)) 
labels5 &lt;- array(&quot;Human Day 0&quot;, dim = c(10304, 1)) 
labels6 &lt;- array(&quot;Human Day 1&quot;, dim = c(10304, 1)) 
labels7 &lt;- array(&quot;Human Day 2&quot;, dim = c(10304, 1)) 
labels8 &lt;- array(&quot;Human Day 3&quot;, dim = c(10304, 1)) 

# Make species-day labels
labels9 &lt;- rbind(labels1, labels2, labels3, labels4, labels5, labels6, labels7, labels8)
labels &lt;- as.numeric(as.factor(labels9))
# Make labels so same days from different species are the same color
labels10 &lt;- rbind(labels1, labels2, labels3, labels4, labels1, labels2, labels3, labels4)
labels10 &lt;- as.numeric(as.factor(labels10))

#1 Overall trend across genes

# Boxplot of means gives general trend

# Combine means
HC_mean &lt;- rbind(as.data.frame(chimps_day0_mean), as.data.frame(chimps_day1_mean), as.data.frame(chimps_day2_mean), as.data.frame(chimps_day3_mean), as.data.frame(humans_day0_mean), as.data.frame(humans_day1_mean), as.data.frame(humans_day2_mean), as.data.frame(humans_day3_mean))

HC_mean_labels &lt;- cbind(HC_mean, labels, labels10)

m &lt;- ggplot(HC_mean_labels, aes(x = factor(labels), y = HC_mean))
m &lt;- m + geom_violin(aes(fill = factor(labels10)), show.legend = FALSE) + geom_boxplot(aes(fill = factor(labels10)), show.legend = FALSE, outlier.shape = NA,width=0.2) + scale_y_continuous(trans = &quot;log2&quot;) + ggtitle(&quot;Mean for each gene by species and day&quot;) + xlab(&quot;Species-Day Pair&quot;) + ylab(&quot;Mean for each gene&quot;) 
m &lt;- m + scale_x_discrete(labels=c(&quot;1&quot; = &quot;C Day 0&quot;, &quot;2&quot; = &quot;C Day 1&quot;, &quot;3&quot; = &quot;C Day 2&quot;, &quot;4&quot; = &quot;C Day 3&quot;, &quot;5&quot; = &quot;H Day 0&quot;, &quot;6&quot; = &quot;H Day 1&quot;, &quot;7&quot; = &quot;H Day 2&quot;, &quot;8&quot; = &quot;H Day 3&quot;))
m</code></pre>
<pre><code>Warning in self$trans$transform(x): NaNs produced

Warning in self$trans$transform(x): NaNs produced</code></pre>
<pre><code>Warning: Removed 144 rows containing non-finite values (stat_ydensity).</code></pre>
<pre><code>Warning: Removed 144 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Boxplot of variances gives general trend
HC_var &lt;- rbind(as.data.frame(chimps_day0_var), as.data.frame(chimps_day1_var), as.data.frame(chimps_day2_var), as.data.frame(chimps_day3_var), as.data.frame(humans_day0_var), as.data.frame(humans_day1_var), as.data.frame(humans_day2_var), as.data.frame(humans_day3_var))

HC_var_labels &lt;- cbind(HC_var, labels, labels10)

p &lt;- ggplot(HC_var_labels, aes(x = factor(labels), y = HC_var))
p &lt;- p + geom_violin(aes(fill = factor(labels10)), show.legend = FALSE) + geom_boxplot(aes(fill = factor(labels10)), show.legend = FALSE, outlier.shape = NA,width=0.2) + scale_y_continuous(trans = &quot;log2&quot;) + ggtitle(&quot;Variance for each gene by species and day&quot;) + xlab(&quot;Species-Day Pair&quot;) + ylab(&quot;Variance for each gene&quot;) 
p &lt;- p + scale_x_discrete(labels=c(&quot;1&quot; = &quot;C Day 0&quot;, &quot;2&quot; = &quot;C Day 1&quot;, &quot;3&quot; = &quot;C Day 2&quot;, &quot;4&quot; = &quot;C Day 3&quot;, &quot;5&quot; = &quot;H Day 0&quot;, &quot;6&quot; = &quot;H Day 1&quot;, &quot;7&quot; = &quot;H Day 2&quot;, &quot;8&quot; = &quot;H Day 3&quot;))
p</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-3-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="evaluating-global-changes-in-variation" class="section level1">
<h1>Evaluating global changes in variation</h1>
<div id="no-global-reduction-in-means-between-day-0-and-day-1" class="section level2">
<h2>No global reduction in means between day 0 and day 1</h2>
<p>Check to see if differences between means (of all gene expression values) within humans and chimps</p>
<pre class="r"><code>########## Within chimps ##########

# Test at least one of the means is different
group &lt;- rbind(labels1, labels2, labels3, labels4)

mean_day_species &lt;- rbind(chimps_day0_mean,chimps_day1_mean, chimps_day2_mean, chimps_day3_mean)

aov_groups &lt;- cbind(mean_day_species, group)

dim(aov_groups)</code></pre>
<pre><code>[1] 41216     2</code></pre>
<pre class="r"><code>aov_bet &lt;- oneway.test(aov_groups$Mean ~ aov_groups$group)
aov_bet</code></pre>
<pre><code>
    One-way analysis of means (not assuming equal variances)

data:  aov_groups$Mean and aov_groups$group
F = 4.4683, num df = 3, denom df = 22893, p-value = 0.003845</code></pre>
<pre class="r"><code>#F = 4.4683, num df = 3, denom df = 22893, p-value = 0.003845

# Test groups individually

# Day 0 and Day 1
t.test(chimps_day0_mean, chimps_day1_mean) # 0.5399</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  chimps_day0_mean and chimps_day1_mean
t = -0.61296, df = 20603, p-value = 0.5399
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.07034817  0.03683081
sample estimates:
mean of x mean of y 
 5.220686  5.237444 </code></pre>
<pre class="r"><code># Day 1 and Day 2
t.test(chimps_day1_mean, chimps_day2_mean) # 0.03798</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  chimps_day1_mean and chimps_day2_mean
t = -2.0752, df = 20591, p-value = 0.03798
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.108150478 -0.003085867
sample estimates:
mean of x mean of y 
 5.237444  5.293062 </code></pre>
<pre class="r"><code># Day 2 and Day 3
t.test(chimps_day2_mean, chimps_day3_mean) # 0.7277</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  chimps_day2_mean and chimps_day3_mean
t = -0.34825, df = 20604, p-value = 0.7277
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.06130927  0.04281031
sample estimates:
mean of x mean of y 
 5.293062  5.302312 </code></pre>
<pre class="r"><code>########## Within humans ##########

# Test at least one of the means is different
group &lt;- rbind(labels5, labels6, labels7, labels8)

mean_day_species &lt;- rbind(humans_day0_mean,humans_day1_mean, humans_day2_mean, humans_day3_mean)

aov_groups &lt;- cbind(mean_day_species, group)

dim(aov_groups)</code></pre>
<pre><code>[1] 41216     2</code></pre>
<pre class="r"><code>aov_bet &lt;- oneway.test(aov_groups$Mean ~ aov_groups$group)
aov_bet</code></pre>
<pre><code>
    One-way analysis of means (not assuming equal variances)

data:  aov_groups$Mean and aov_groups$group
F = 6.2552, num df = 3, denom df = 22892, p-value = 0.0003067</code></pre>
<pre class="r"><code># F = 6.2552, num df = 3, denom df = 22892, p-value = 0.0003067

# Test groups individually

# Day 0 and Day 1
t.test(humans_day0_mean, humans_day1_mean) # 0.73</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  humans_day0_mean and humans_day1_mean
t = -0.34116, df = 20606, p-value = 0.733
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.06092309  0.04285910
sample estimates:
mean of x mean of y 
 5.285916  5.294948 </code></pre>
<pre class="r"><code># Day 1 and Day 2
t.test(humans_day1_mean, humans_day2_mean) # 0.009</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  humans_day1_mean and humans_day2_mean
t = -2.5801, df = 20581, p-value = 0.009883
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.11825984 -0.01615061
sample estimates:
mean of x mean of y 
 5.294948  5.362153 </code></pre>
<pre class="r"><code># Day 2 and Day 3
t.test(humans_day2_mean, humans_day3_mean) # 0.5806</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  humans_day2_mean and humans_day3_mean
t = -0.55246, df = 20606, p-value = 0.5806
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.06421897  0.03597774
sample estimates:
mean of x mean of y 
 5.362153  5.376273 </code></pre>
<p>Conclusion: For both species, there is at least 1 mean that is different; however, when testing between the chimps day 0 and 1, there is not enough statistical evidence to suggest a difference in the means of the variances (p = 0.53).</p>
</div>
<div id="no-global-reduction-in-variance-between-day-0-and-1-in-both-species" class="section level2">
<h2>No global reduction in variance between day 0 and 1 in both species</h2>
<p>Check to see if differences between means (of the variances of all of the genes) within humans and chimps</p>
<pre class="r"><code>########## Within chimps ##########

# Test at least one of the means is different
group &lt;- rbind(labels1, labels2, labels3, labels4)

var_day_species &lt;- rbind(chimps_day0_var,chimps_day1_var, chimps_day2_var, chimps_day3_var)

aov_groups &lt;- cbind(var_day_species, group)

dim(aov_groups)</code></pre>
<pre><code>[1] 41216     2</code></pre>
<pre class="r"><code>aov_bet &lt;- oneway.test(aov_groups$Variance ~ aov_groups$group)
aov_bet</code></pre>
<pre><code>
    One-way analysis of means (not assuming equal variances)

data:  aov_groups$Variance and aov_groups$group
F = 16.803, num df = 3, denom df = 22848, p-value = 6.715e-11</code></pre>
<pre class="r"><code># F = 16.803, num df = 3, denom df = 22848, p-value = 6.715e-11

# Test groups individually

# Day 0 and Day 1
t.test(chimps_day0_var, chimps_day1_var) # 0.4586</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  chimps_day0_var and chimps_day1_var
t = 0.74112, df = 20602, p-value = 0.4586
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.009003645  0.019951877
sample estimates:
mean of x mean of y 
0.1066976 0.1012235 </code></pre>
<pre class="r"><code>t.test(chimps_day0_var, chimps_day1_var, alternative = &quot;greater&quot;) # 0.2293</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  chimps_day0_var and chimps_day1_var
t = 0.74112, df = 20602, p-value = 0.2293
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 -0.006675837          Inf
sample estimates:
mean of x mean of y 
0.1066976 0.1012235 </code></pre>
<pre class="r"><code># Day 1 and Day 2
t.test(chimps_day1_var, chimps_day2_var) # 0.03103</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  chimps_day1_var and chimps_day2_var
t = -2.1569, df = 20602, p-value = 0.03103
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.030404332 -0.001453377
sample estimates:
mean of x mean of y 
0.1012235 0.1171524 </code></pre>
<pre class="r"><code># Day 2 and Day 3
t.test(chimps_day2_var, chimps_day3_var) # 2.992e-06</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  chimps_day2_var and chimps_day3_var
t = -4.6727, df = 19996, p-value = 2.992e-06
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.05354353 -0.02189784
sample estimates:
mean of x mean of y 
0.1171524 0.1548730 </code></pre>
<pre class="r"><code>########## Within humans ##########

# Test at least one of the means is different
group &lt;- rbind(labels5, labels6, labels7, labels8)

var_day_species &lt;- rbind(humans_day0_var,humans_day1_var, humans_day2_var, humans_day3_var)

aov_groups &lt;- cbind(var_day_species, group)

dim(aov_groups)</code></pre>
<pre><code>[1] 41216     2</code></pre>
<pre class="r"><code>aov_bet &lt;- oneway.test(aov_groups$Variance ~ aov_groups$group)
aov_bet</code></pre>
<pre><code>
    One-way analysis of means (not assuming equal variances)

data:  aov_groups$Variance and aov_groups$group
F = 80.035, num df = 3, denom df = 22652, p-value &lt; 2.2e-16</code></pre>
<pre class="r"><code># F = 80.035, num df = 3, denom df = 22652, p-value &lt; 2.2e-16

# Test groups individually

# Day 0 and Day 1
t.test(humans_day0_var, humans_day1_var) # &lt; 2.2e-16</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  humans_day0_var and humans_day1_var
t = 13.533, df = 19259, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.0768552 0.1028897
sample estimates:
 mean of x  mean of y 
0.18524994 0.09537748 </code></pre>
<pre class="r"><code># Day 1 and Day 2
t.test(humans_day1_var, humans_day2_var) # &lt; 2.2e-16</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  humans_day1_var and humans_day2_var
t = -8.765, df = 20334, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.05783207 -0.03669358
sample estimates:
 mean of x  mean of y 
0.09537748 0.14264030 </code></pre>
<pre class="r"><code># Day 2 and Day 3
t.test(humans_day2_var, humans_day3_var) # 7.301e-07</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  humans_day2_var and humans_day3_var
t = -4.9549, df = 18769, p-value = 7.301e-07
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.04229841 -0.01831887
sample estimates:
mean of x mean of y 
0.1426403 0.1729489 </code></pre>
<p>Conclusion: For both species, there is at least 1 mean (of the variances) that is different; however, when testing between the chimps day 0 and 1, there is not enough statistical evidence to suggest a difference in the means of the variances (p = 0.4586). Even if you make the argument that biologically we expect a reduction in variance between day 0 an day 1 (due to cannalization, for example) and therefore try a one-sided t-test, the p-value is still not statistically significant (p = 0.2293).</p>
</div>
</div>
<div id="characterizing-variance-trends-between-days" class="section level1">
<h1>Characterizing variance trends between days</h1>
<p>We are interested in the genes that experience either an increase or reduction in variance between days in both species.</p>
<div id="which-individual-genes-undergo-an-increase-or-reduction-in-variation-in-one-species-given-an-increase-or-reduction-in-variation-in-the-other-species" class="section level2">
<h2>Which individual genes undergo an increase or reduction in variation in one species given an increase or reduction in variation in the other species?</h2>
<p>We are going to first use a parametric test.</p>
<div id="general-functions-for-reductionincrease-in-variance" class="section level3">
<h3>General functions for reduction/increase in variance</h3>
<pre class="r"><code>## Original code for the qqplots provided by Bryce van de Geijn.
#Output:                                                                                                                                  
#adds a set of qq points to an existing graph                                                                                             

addqqplot=function(pvals, always.plot,density, col_designated){
  len = length(pvals)
  res=qqplot(-log10((1:len)/(1+len)),pvals,plot.it=F)
  return(res)
}

#newqqplot creates a new plot with a set of qq points                                                                                     
#Output:                                                                                                                                  
#creates a new qq plot                                                                                                                    

newqqplot=function(pvals, always.plot,density){
  len = length(pvals)
  res=qqplot(-log10((1:len)/(1+len)),pvals,plot.it=F)
}</code></pre>
<pre class="r"><code># 1A) Reduction in variation. Enrichment in chimps given that the gene was significant in humans

# We need 4 values for each species: day t-1 start and end values and day t start and end values.

find_qqplot_red_chimps &lt;- function(chimp_begin_column_tm1, chimp_end_column_tm1, chimp_begin_column_t, chimp_end_column_t, human_begin_column_tm1, human_end_column_tm1, human_begin_column_t, human_end_column_t){

  # Make an array to store the Chimp p-values

  chimp_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,chimp_begin_column_tm1:chimp_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,chimp_begin_column_t:chimp_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;greater&quot;))
    chimp_var_pval[i,1] &lt;- htest$p.value
  }

  hist(chimp_var_pval)

############## For humans

  human_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,human_begin_column_tm1:human_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,human_begin_column_t:human_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;greater&quot;))
    human_var_pval[i,1] &lt;- htest$p.value
  }

  hist(human_var_pval)

############ Find p-values of the F_statistics

# Make one data frame

  var_pval &lt;- as.data.frame(cbind(chimp_var_pval, human_var_pval))
  rownames(var_pval) &lt;- rownames(mean_tech_reps)
  colnames(var_pval) &lt;- c(&quot;Chimpanzee&quot;, &quot;Human&quot;)
  summary(var_pval)

  dim(var_pval)

# Set p-value

  p_val &lt;- 0.05

# P-val &lt; 0.05 for chimps only
  num_var_pval_chimps &lt;- var_pval[ which(var_pval[,1] &lt; p_val), ]

                    
# P-val &lt; 0.05 for humans only
  num_var_pval_humans &lt;- var_pval[ which(var_pval[,2] &lt; p_val), ]
  
# A data frame with the # of genes with significant p-values  
  sig_p_val &lt;- as.data.frame(rbind(dim(num_var_pval_chimps), dim(num_var_pval_humans)))[,1]
  
# Run for the chimps
  num_var_pval_chimps_neg_log &lt;- -log10(var_pval[,1])

  res_chimp &lt;- newqqplot(num_var_pval_chimps_neg_log, -1, 100)

# Run for the shared
  # Find the p-values of the chimps given that it was significant in the humans

  subset_var &lt;- as.data.frame(var_pval[ which(var_pval[,2] &lt; 0.05), 1:2])
  num_var_pval_chimp_given_human_no_df &lt;- subset_var[,1]
  num_var_pval_chimp_given_human &lt;- as.data.frame(subset_var[,1])
 
  num_var_pval_shared_neg_log &lt;- -log10(num_var_pval_chimp_given_human)

  res_shared &lt;- addqqplot(num_var_pval_shared_neg_log[,1], -1, 100, pal[3])

  # Information for plotting

  list_values = list(chimp_var_pval, num_var_pval_chimp_given_human_no_df, sig_p_val, res_chimp$x, res_chimp$y, res_shared$x, res_shared$y, max(res_chimp$x), max(res_chimp$y),  max(res_shared$x),  max(res_shared$y))
  
  
  return(list_values)

}

# 2A) Increase in variation. Enrichment in chimps given that the gene was significant in humans

# We need 4 values for each species: day t-1 start and end values and day t start and end values.

find_qqplot_inc_chimps &lt;- function(chimp_begin_column_tm1, chimp_end_column_tm1, chimp_begin_column_t, chimp_end_column_t, human_begin_column_tm1, human_end_column_tm1, human_begin_column_t, human_end_column_t){

  # Make an array to store the Chimp p-values

  chimp_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,chimp_begin_column_tm1:chimp_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,chimp_begin_column_t:chimp_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;less&quot;))
    chimp_var_pval[i,1] &lt;- htest$p.value
  }

  hist(chimp_var_pval)

############## For humans

  human_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,human_begin_column_tm1:human_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,human_begin_column_t:human_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;less&quot;))
    human_var_pval[i,1] &lt;- htest$p.value
  }

  hist(human_var_pval)

############ Find p-values of the F_statistics

# Make one data frame

  var_pval &lt;- as.data.frame(cbind(chimp_var_pval, human_var_pval))
  rownames(var_pval) &lt;- rownames(mean_tech_reps)
  colnames(var_pval) &lt;- c(&quot;Chimpanzee&quot;, &quot;Human&quot;)
  summary(var_pval)

  dim(var_pval)

# Set p-value

  p_val &lt;- 0.05

# P-val &lt; 0.05 for chimps only
  num_var_pval_chimps &lt;- var_pval[ which(var_pval[,1] &lt; p_val), ]

                    
# P-val &lt; 0.05 for humans only
  num_var_pval_humans &lt;- var_pval[ which(var_pval[,2] &lt; p_val), ]
  
# A data frame with the # of genes with significant p-values  
  sig_p_val &lt;- as.data.frame(rbind(dim(num_var_pval_chimps), dim(num_var_pval_humans)))[,1]
  
# Run for the chimps
  num_var_pval_chimps_neg_log &lt;- -log10(var_pval[,1])

  res_chimp &lt;- newqqplot(num_var_pval_chimps_neg_log, -1, 100)

# Run for the shared
  # Find the p-values of the chimps given that it was significant in the humans

  subset_var &lt;- as.data.frame(var_pval[ which(var_pval[,2] &lt; 0.05), 1:2])
  num_var_pval_chimp_given_human_no_df &lt;- subset_var[,1]
  num_var_pval_chimp_given_human &lt;- as.data.frame(subset_var[,1])
 
  num_var_pval_shared_neg_log &lt;- -log10(num_var_pval_chimp_given_human)

  res_shared &lt;- addqqplot(num_var_pval_shared_neg_log[,1], -1, 100, pal[3])

  # Information for plotting

  list_values = list(chimp_var_pval, num_var_pval_chimp_given_human_no_df, sig_p_val, res_chimp$x, res_chimp$y, res_shared$x, res_shared$y, max(res_chimp$x), max(res_chimp$y),  max(res_shared$x),  max(res_shared$y))
  
  
  return(list_values)

}

# 1B) Reduction in variation. Enrichment in humans given that the gene was significant in chimps

# We need 4 values for each species: day t-1 start and end values and day t start and end values.

find_qqplot_red_humans &lt;- function(chimp_begin_column_tm1, chimp_end_column_tm1, chimp_begin_column_t, chimp_end_column_t, human_begin_column_tm1, human_end_column_tm1, human_begin_column_t, human_end_column_t){

  # Make an array to store the Chimp p-values

  chimp_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,chimp_begin_column_tm1:chimp_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,chimp_begin_column_t:chimp_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;greater&quot;))
    chimp_var_pval[i,1] &lt;- htest$p.value
  }

  hist(chimp_var_pval)

############## For humans

  human_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,human_begin_column_tm1:human_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,human_begin_column_t:human_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;greater&quot;))
    human_var_pval[i,1] &lt;- htest$p.value
  }

  hist(human_var_pval)

############ Find p-values of the F_statistics

# Make one data frame

  var_pval &lt;- as.data.frame(cbind(chimp_var_pval, human_var_pval))
  rownames(var_pval) &lt;- rownames(mean_tech_reps)
  colnames(var_pval) &lt;- c(&quot;Chimpanzee&quot;, &quot;Human&quot;)
  summary(var_pval)

  dim(var_pval)

# Set p-value

  p_val &lt;- 0.05

# P-val &lt; 0.05 for chimps only
  num_var_pval_chimps &lt;- var_pval[ which(var_pval[,1] &lt; p_val), ]

                    
# P-val &lt; 0.05 for humans only
  num_var_pval_humans &lt;- var_pval[ which(var_pval[,2] &lt; p_val), ]
  
# A data frame with the # of genes with significant p-values  
  sig_p_val &lt;- as.data.frame(rbind(dim(num_var_pval_chimps), dim(num_var_pval_humans)))[,1]
  
# Run for the humans
  num_var_pval_chimps_neg_log &lt;- -log10(var_pval[,2])

  res_chimp &lt;- newqqplot(num_var_pval_chimps_neg_log, -1, 100)

# Run for the shared
  # Find the p-values of the humans given that it was significant in the chimps

  subset_var &lt;- as.data.frame(var_pval[ which(var_pval[,1] &lt; 0.05), 1:2])
  num_var_pval_human_given_chimp_no_df &lt;- subset_var[,2]
  num_var_pval_human_given_chimp &lt;- as.data.frame(subset_var[,2])
 
  num_var_pval_shared_neg_log &lt;- -log10(num_var_pval_human_given_chimp)

  res_shared &lt;- addqqplot(num_var_pval_shared_neg_log[,1], -1, 100, pal[3])

  # Information for plotting

  list_values = list(human_var_pval, num_var_pval_human_given_chimp_no_df, sig_p_val, res_chimp$x, res_chimp$y, res_shared$x, res_shared$y, max(res_chimp$x), max(res_chimp$y),  max(res_shared$x),  max(res_shared$y))
  
  
  return(list_values)

}

# 2B) Reduction in variation. Enrichment in humans given that the gene was significant in chimps

# We need 4 values for each species: day t-1 start and end values and day t start and end values.

find_qqplot_inc_humans &lt;- function(chimp_begin_column_tm1, chimp_end_column_tm1, chimp_begin_column_t, chimp_end_column_t, human_begin_column_tm1, human_end_column_tm1, human_begin_column_t, human_end_column_t){

  # Make an array to store the Chimp p-values

  chimp_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,chimp_begin_column_tm1:chimp_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,chimp_begin_column_t:chimp_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;less&quot;))
    chimp_var_pval[i,1] &lt;- htest$p.value
  }

  hist(chimp_var_pval)

############## For humans

  human_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,human_begin_column_tm1:human_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,human_begin_column_t:human_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;less&quot;))
    human_var_pval[i,1] &lt;- htest$p.value
  }

  hist(human_var_pval)

############ Find p-values of the F_statistics

# Make one data frame

  var_pval &lt;- as.data.frame(cbind(chimp_var_pval, human_var_pval))
  rownames(var_pval) &lt;- rownames(mean_tech_reps)
  colnames(var_pval) &lt;- c(&quot;Chimpanzee&quot;, &quot;Human&quot;)
  summary(var_pval)

  dim(var_pval)

# Set p-value

  p_val &lt;- 0.05

# P-val &lt; 0.05 for chimps only
  num_var_pval_chimps &lt;- var_pval[ which(var_pval[,1] &lt; p_val), ]

                    
# P-val &lt; 0.05 for humans only
  num_var_pval_humans &lt;- var_pval[ which(var_pval[,2] &lt; p_val), ]
  
# A data frame with the # of genes with significant p-values  
  sig_p_val &lt;- as.data.frame(rbind(dim(num_var_pval_chimps), dim(num_var_pval_humans)))[,1]
  
# Run for the humans
  num_var_pval_chimps_neg_log &lt;- -log10(var_pval[,2])

  res_chimp &lt;- newqqplot(num_var_pval_chimps_neg_log, -1, 100)

# Run for the shared
  # Find the p-values of the humans given that it was significant in the chimps

  subset_var &lt;- as.data.frame(var_pval[ which(var_pval[,1] &lt; 0.05), 1:2])
  num_var_pval_human_given_chimp_no_df &lt;- subset_var[,2]
  num_var_pval_human_given_chimp &lt;- as.data.frame(subset_var[,2])
 
  num_var_pval_shared_neg_log &lt;- -log10(num_var_pval_human_given_chimp)

  res_shared &lt;- addqqplot(num_var_pval_shared_neg_log[,1], -1, 100, pal[3])

  # Information for plotting

  list_values = list(human_var_pval, num_var_pval_human_given_chimp_no_df, sig_p_val, res_chimp$x, res_chimp$y, res_shared$x, res_shared$y, max(res_chimp$x), max(res_chimp$y),  max(res_shared$x),  max(res_shared$y))
  
  
  return(list_values)

}

# Make multiple ggplots on the same page

# Multiplot function (from http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_%28ggplot2%29/)

multiplot &lt;- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
  library(grid)

  # Make a list from the ... arguments and plotlist
  plots &lt;- c(list(...), plotlist)

  numPlots = length(plots)

  # If layout is NULL, then use &#39;cols&#39; to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout &lt;- matrix(seq(1, cols * ceiling(numPlots/cols)),
                    ncol = cols, nrow = ceiling(numPlots/cols))
  }

 if (numPlots==1) {
    print(plots[[1]])

  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))

    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx &lt;- as.data.frame(which(layout == i, arr.ind = TRUE))

      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}</code></pre>
</div>
<div id="enrichment-in-chimps" class="section level3">
<h3>Enrichment in chimps</h3>
<pre class="r"><code># Reduction in variance from day 0 to day 1 chimps

qqplot_red_day01 &lt;- find_qqplot_red_chimps(7,10,17,20,1,6,11,16)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction in variance from day 1 to day 2 chimps

qqplot_red_day12 &lt;- find_qqplot_red_chimps(17,20,27,30,11,16,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-3.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction in variance from day 2 to day 3 chimps

qqplot_red_day23 &lt;- find_qqplot_red_chimps(27,30,37,40,21,26,31,36)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-5.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-6.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction in variance from day 0 to day 2 chimps

qqplot_red_day02 &lt;- find_qqplot_red_chimps(7,10,27,30,1,6,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-7.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-8.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 0 to day 1

qqplot_inc_day01 &lt;- find_qqplot_inc_chimps(7,10,17,20,1,6,11,16)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-9.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-10.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 1 to day 2

qqplot_inc_day12 &lt;- find_qqplot_inc_chimps(17,20,27,30,11,16,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-11.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-12.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 2 to day 3

qqplot_inc_day23 &lt;- find_qqplot_inc_chimps(27,30,37,40,21,26,31,36)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-13.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-14.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 0 to day 2

qqplot_inc_day02 &lt;- find_qqplot_inc_chimps(7,10,27,30,1,6,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-15.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-16.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction of variance qqplots- chimps

par(mfrow=c(2,4),oma = c(2, 2, 2, 2))

# Reduction of variance to day 0 to 1 chimps
plot(qqplot_red_day01[[4]],qqplot_red_day01[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;, main = &quot;Day 0 to 1&quot;)
abline(0,1, col = &quot;black&quot;)

# Add to the plot
points(qqplot_red_day01[[6]],qqplot_red_day01[[7]], pch = 16, col = pal[3])

# Reduction of variance to day 1 to 2
plot(qqplot_red_day12[[4]],qqplot_red_day12[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;, main = &quot;Day 1 to 2&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_red_day12[[6]],qqplot_red_day12[[7]], pch = 16, col = pal[3])

# Reduction of variance to day 2 to 3
plot(qqplot_red_day23[[4]],qqplot_red_day23[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;, main = &quot;Day 2 to 3&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_red_day23[[6]],qqplot_red_day23[[7]], pch = 16, col = pal[3])

# Reduction of variance to day 0 to 2
plot(qqplot_red_day02[[4]],qqplot_red_day02[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;, main = &quot;Day 0 to 2&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_red_day02[[6]],qqplot_red_day02[[7]], pch = 16, col = pal[3])

# Add bottom title

mtext(&quot;Reduction in Variation&quot;, font = 2, side = 3, line = -1.5, outer = TRUE)

### Increase in variance

# Inc variance to day 0 to 1
plot(qqplot_inc_day01[[4]],qqplot_inc_day01[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;,  main = &quot;Day 0 to 1&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_inc_day01[[6]],qqplot_inc_day01[[7]], pch = 16, col = pal[3])

# Increase of variance to day 1 to 2
plot(qqplot_inc_day12[[4]],qqplot_inc_day12[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;,  main = &quot;Day 1 to 2&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_inc_day12[[6]],qqplot_inc_day12[[7]], pch = 16, col = pal[3])


# Increase of variance to day 2 to 3
plot(qqplot_inc_day23[[4]],qqplot_inc_day23[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;,  main = &quot;Day 2 to 3&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_inc_day23[[6]],qqplot_inc_day23[[7]], pch = 16, col = pal[3])

# Increase of variance to day 0 to 2
plot(qqplot_inc_day02[[4]],qqplot_inc_day02[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;,  main = &quot;Day 0 to 2&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_inc_day02[[6]],qqplot_inc_day02[[7]], pch = 16, col = pal[3])


mtext(&quot;Increase in Variation&quot;, font = 2, side = 3, line = -29, outer = TRUE)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = &quot;n&quot;, bty = &quot;n&quot;, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;)
legend(&quot;bottomright&quot;, c(&quot;Chimpanzee&quot;, &quot;Chimpanzee|significant in humans&quot;), xpd = TRUE, horiz = TRUE, inset = c(0,  0), bty = &quot;n&quot;, pch = c(16, 16), col = pal[2:3], cex = 1.5)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-8-17.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="estimates-of-pi0-and-pi1" class="section level3">
<h3>Estimates of pi0 and pi1</h3>
<pre class="r"><code>library(&quot;qvalue&quot;)
################ REDUCTION IN VARIATION FOR CHIMPS################

# Day 0 to 1


# Obtain pvalues
chimp_p_values_gen &lt;- as.data.frame(qqplot_red_day01[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_red_day01[2])


# Pi_0 estimate for the chimps

pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.7442989

$pi0.lambda
 [1] 0.9901111 0.9839760 0.9735796 0.9675854 0.9543219 0.9433230 0.9382465
 [8] 0.9248835 0.9085615 0.8911102 0.8658989 0.8380241 0.8196539 0.8090709
[15] 0.7915373 0.7739713 0.7699275 0.7501941 0.7705745

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 1.0010355 0.9892169 0.9773043 0.9651713 0.9526678 0.9396535 0.9260055
 [8] 0.9116382 0.8965538 0.8808566 0.8647461 0.8484933 0.8323753 0.8165982
[15] 0.8012766 0.7864558 0.7721024 0.7581014 0.7442989</code></pre>
<pre class="r"><code>pi0est_chimps &lt;- pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps</code></pre>
<pre><code>[1] 0.7442989</code></pre>
<pre class="r"><code># Pi_1 estimate for the chimps

pi1est_chimps &lt;- 1 - pi0est_chimps
pi1est_chimps</code></pre>
<pre><code>[1] 0.2557011</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.5237662

$pi0.lambda
 [1] 0.9795130 0.9679142 0.9503251 0.9294452 0.9086938 0.8874743 0.8670229
 [8] 0.8497160 0.8157592 0.7898646 0.7650114 0.7208388 0.6940024 0.6567642
[15] 0.6133683 0.5919616 0.5912334 0.5286151 0.5504587

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9954502 0.9736303 0.9516761 0.9294209 0.9066837 0.8832842 0.8590584
 [8] 0.8338779 0.8076829 0.7805190 0.7525081 0.7238488 0.6948144 0.6656781
[15] 0.6366925 0.6080313 0.5797111 0.5516477 0.5237662</code></pre>
<pre class="r"><code>pi0est_chimps_given_humans &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps_given_humans</code></pre>
<pre><code>[1] 0.5237662</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_chimps_given_humans &lt;- 1 - pi0est_chimps_given_humans
pi1est_chimps_given_humans</code></pre>
<pre><code>[1] 0.4762338</code></pre>
<pre class="r"><code>pi0est_chimps_given_humans*as.data.frame(qqplot_red_day01[[3]][2])</code></pre>
<pre><code>  qqplot_red_day01[[3]][2]
1                 1198.901</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_c &lt;- array(&quot;Chimpanzee&quot;, dim = c(10304,1))
labels_h &lt;- array(&quot;Shared (Chimpanzee|Significant in Humans)&quot;, dim = c(as.data.frame(qqplot_red_day01[[3]][2]),1))

chimps &lt;- cbind(labels_c, chimp_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
humans &lt;- cbind(labels_h, shared_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(chimps[,1:2], humans[,1:2])


p1 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 0 to 1&quot;) +
  geom_hline(yintercept = pi0est_chimps_given_humans) + 
  geom_hline(yintercept = pi0est_chimps) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, chimp&quot;])==&quot;0.74&quot;&#39;, parse=TRUE, x=0.4, y=(pi0est_chimps+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.52&quot;&#39;, parse=TRUE, x=0.4, y=(pi0est_chimps_given_humans+0.07))

p1</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Day 1 to 2


# Obtain pvalues
chimp_p_values_gen &lt;- as.data.frame(qqplot_red_day12[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_red_day12[2])


# Pi_0 estimate for the chimps

pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 1

$pi0.lambda
 [1] 1.025662 1.048676 1.074397 1.101878 1.127200 1.151980 1.175346
 [8] 1.199372 1.224061 1.234666 1.240942 1.244177 1.252496 1.243530
[15] 1.213509 1.184006 1.141951 1.110248 1.030668

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 1.043995 1.067682 1.091199 1.114250 1.136412 1.157158 1.175892
 [8] 1.191976 1.204773 1.213709 1.218351 1.218432 1.213866 1.204788
[15] 1.191618 1.175067 1.156023 1.135432 1.114143</code></pre>
<pre class="r"><code>pi0est_chimps &lt;- pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="r"><code># Pi_1 estimate for the chimps

pi1est_chimps &lt;- 1 - pi0est_chimps
pi1est_chimps</code></pre>
<pre><code>[1] 0</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.5740085

$pi0.lambda
 [1] 1.0036720 1.0335917 1.0396717 1.0368217 1.0542636 1.0520487 1.0494931
 [8] 1.0077519 0.9725159 0.9302326 0.9130060 0.7364341 0.7751938 0.7751938
[15] 0.7131783 0.7364341 0.7751938 0.6201550 0.4651163

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 1.0688505 1.0602182 1.0510320 1.0405818 1.0280568 1.0126459 0.9937244
 [8] 0.9709852 0.9445182 0.9147192 0.8822020 0.8477405 0.8121456 0.7756287
[15] 0.7380574 0.6992151 0.6588018 0.6168362 0.5740085</code></pre>
<pre class="r"><code>pi0est_chimps_given_humans &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps_given_humans</code></pre>
<pre><code>[1] 0.5740085</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_chimps_given_humans &lt;- 1 - pi0est_chimps_given_humans
pi1est_chimps_given_humans</code></pre>
<pre><code>[1] 0.4259915</code></pre>
<pre class="r"><code>pi0est_chimps_given_humans*as.data.frame(qqplot_red_day12[[3]][2])</code></pre>
<pre><code>  qqplot_red_day12[[3]][2]
1                  74.0471</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_c &lt;- array(&quot;Chimpanzee&quot;, dim = c(10304,1))
labels_h &lt;- array(&quot;Shared (Chimpanzee|Significant in Humans)&quot;, dim = c(as.data.frame(qqplot_red_day12[[3]][2]),1))

chimps &lt;- cbind(labels_c, chimp_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
humans &lt;- cbind(labels_h, shared_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(chimps[,1:2], humans[,1:2])


p2 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 1 to 2&quot;) +
  geom_hline(yintercept = pi0est_chimps_given_humans) + 
  geom_hline(yintercept = pi0est_chimps) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, chimp&quot;])==&quot;1&quot;&#39;, parse=TRUE, x=0.6, y=(pi0est_chimps+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.57&quot;&#39;, parse=TRUE, x=0.6, y=(pi0est_chimps_given_humans+0.07))

p2</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-9-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Day 2 to 3

# Obtain pvalues
chimp_p_values_gen &lt;- as.data.frame(qqplot_red_day23[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_red_day23[2])


# Pi_0 estimate for the chimps

pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.9067532

$pi0.lambda
 [1] 1.0333238 1.0663604 1.0941496 1.1225010 1.1494565 1.1702806 1.1857979
 [8] 1.1988872 1.1947699 1.1906056 1.1760266 1.1556192 1.1249445 1.0869565
[15] 1.0395963 1.0000970 0.9517340 0.8782997 0.8947981

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 1.0826692 1.0997488 1.1163916 1.1319541 1.1456180 1.1564905 1.1637049
 [8] 1.1665019 1.1643008 1.1567623 1.1437967 1.1255766 1.1025307 1.0753192
[15] 1.0447767 1.0118221 0.9773471 0.9421399 0.9067532</code></pre>
<pre class="r"><code>pi0est_chimps &lt;- pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps</code></pre>
<pre><code>[1] 0.9067532</code></pre>
<pre class="r"><code># Pi_1 estimate for the chimps

pi1est_chimps &lt;- 1 - pi0est_chimps
pi1est_chimps</code></pre>
<pre><code>[1] 0.09324678</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.9668901

$pi0.lambda
 [1] 1.0327706 1.0575355 1.0827476 1.1294549 1.1712089 1.1859838 1.2062571
 [8] 1.2194270 1.2426148 1.2704403 1.2858141 1.2735849 1.2339024 1.2368973
[15] 1.1572327 1.1111111 1.0901468 0.9853249 0.7966457

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 1.0642231 1.0911047 1.1176917 1.1434648 1.1676564 1.1893830 1.2077568
 [8] 1.2218747 1.2308179 1.2336682 1.2296156 1.2181351 1.1991223 1.1728877
[15] 1.1400843 1.1017738 1.0592061 1.0137441 0.9668901</code></pre>
<pre class="r"><code>pi0est_chimps_given_humans &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps_given_humans</code></pre>
<pre><code>[1] 0.9668901</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_chimps_given_humans &lt;- 1 - pi0est_chimps_given_humans
pi1est_chimps_given_humans</code></pre>
<pre><code>[1] 0.0331099</code></pre>
<pre class="r"><code>pi0est_chimps_given_humans*as.data.frame(qqplot_red_day23[[3]][2])</code></pre>
<pre><code>  qqplot_red_day23[[3]][2]
1                 461.2066</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_c &lt;- array(&quot;Chimpanzee&quot;, dim = c(10304,1))
labels_h &lt;- array(&quot;Shared (Chimpanzee|Significant in Humans)&quot;, dim = c(as.data.frame(qqplot_red_day23[[3]][2]),1))

chimps &lt;- cbind(labels_c, chimp_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
humans &lt;- cbind(labels_h, shared_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(chimps[,1:2], humans[,1:2])


p3 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 2 to 3&quot;) +
  geom_hline(yintercept = pi0est_chimps_given_humans) + 
  geom_hline(yintercept = pi0est_chimps) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, chimp&quot;])==&quot;0.91&quot;&#39;, parse=TRUE, x=0.6, y=(pi0est_chimps-0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.96&quot;&#39;, parse=TRUE, x=0.6, y=(pi0est_chimps_given_humans+0.07))

p3</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-9-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Day 0 to 2

# Obtain pvalues
chimp_p_values_gen &lt;- as.data.frame(qqplot_red_day02[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_red_day02[2])


# Pi_0 estimate for the chimps

pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 1

$pi0.lambda
 [1] 0.9982838 1.0009058 1.0077183 1.0169594 1.0247153 1.0335792 1.0499283
 [8] 1.0605914 1.0733696 1.0910326 1.0986025 1.1053960 1.1202307 1.1380694
[15] 1.1677019 1.1946817 1.2111801 1.2383540 1.3470497

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9870584 0.9963860 1.0058089 1.0154490 1.0254461 1.0359497 1.0471044
 [8] 1.0590449 1.0719197 1.0858912 1.1011386 1.1178666 1.1362569 1.1564005
[15] 1.1782624 1.2016752 1.2263818 1.2520540 1.2782554</code></pre>
<pre class="r"><code>pi0est_chimps &lt;- pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="r"><code># Pi_1 estimate for the chimps

pi1est_chimps &lt;- 1 - pi0est_chimps
pi1est_chimps</code></pre>
<pre><code>[1] 0</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.8067918

$pi0.lambda
 [1] 0.9341536 0.9299343 0.9286139 0.9126984 0.9235209 0.9358895 0.9346209
 [8] 0.9187109 0.9366391 0.9466089 0.9363476 0.9343434 0.9235209 0.9235209
[15] 0.9004329 0.8946609 0.8080808 0.7936508 0.7792208

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9316257 0.9324585 0.9333080 0.9341715 0.9349894 0.9355668 0.9356198
 [8] 0.9348500 0.9329324 0.9294600 0.9240471 0.9164199 0.9064165 0.8940089
[15] 0.8793229 0.8626915 0.8446411 0.8258475 0.8067918</code></pre>
<pre class="r"><code>pi0est_chimps_given_humans &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps_given_humans</code></pre>
<pre><code>[1] 0.8067918</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_chimps_given_humans &lt;- 1 - pi0est_chimps_given_humans
pi1est_chimps_given_humans</code></pre>
<pre><code>[1] 0.1932082</code></pre>
<pre class="r"><code>pi0est_chimps_given_humans*as.data.frame(qqplot_red_day23[[3]][2])</code></pre>
<pre><code>  qqplot_red_day23[[3]][2]
1                 384.8397</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_c &lt;- array(&quot;Chimpanzee&quot;, dim = c(10304,1))
labels_h &lt;- array(&quot;Shared (Chimpanzee|Significant in Humans)&quot;, dim = c(as.data.frame(qqplot_red_day02[[3]][2]),1))

chimps &lt;- cbind(labels_c, chimp_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
humans &lt;- cbind(labels_h, shared_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(chimps[,1:2], humans[,1:2])


p4 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 0 to 2&quot;) +
  geom_hline(yintercept = pi0est_chimps_given_humans) + 
  geom_hline(yintercept = pi0est_chimps) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, chimp&quot;])==&quot;1&quot;&#39;, parse=TRUE, x=0.6, y=(pi0est_chimps+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.81&quot;&#39;, parse=TRUE, x=0.6, y=(pi0est_chimps_given_humans+0.07))

p4</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-9-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>############### Reduction in Variation ############

# Day 0 to 1

# Obtain pvalues
chimp_p_values_gen &lt;- as.data.frame(qqplot_inc_day01[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_inc_day01[2])


# Pi_0 estimate for the chimps

pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 1

$pi0.lambda
 [1] 1.012075 1.027756 1.040601 1.056507 1.069488 1.081827 1.097109
 [8] 1.107984 1.109719 1.108890 1.111758 1.112675 1.114685 1.132246
[15] 1.137034 1.129658 1.149715 1.144216 1.187888

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 1.023164 1.034157 1.045053 1.055716 1.065978 1.075675 1.084669
 [8] 1.092877 1.100311 1.107091 1.113409 1.119478 1.125494 1.131603
[15] 1.137882 1.144399 1.151197 1.158239 1.165441</code></pre>
<pre class="r"><code>pi0est_chimps &lt;- pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="r"><code># Pi_1 estimate for the chimps

pi1est_chimps &lt;- 1 - pi0est_chimps
pi1est_chimps</code></pre>
<pre><code>[1] 0</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.8573164

$pi0.lambda
 [1] 0.9461857 0.9488140 0.9385327 0.9550562 0.9438202 0.9470305 1.0025929
 [8] 0.9363296 0.8988764 0.8764045 0.9488140 0.9550562 0.8988764 0.8988764
[15] 0.8539326 0.8988764 0.8988764 0.7865169 0.8988764

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9554371 0.9536859 0.9518546 0.9498197 0.9473875 0.9443694 0.9405687
 [8] 0.9358801 0.9305317 0.9247940 0.9187063 0.9120487 0.9047541 0.8970158
[15] 0.8890554 0.8810499 0.8730160 0.8650529 0.8573164</code></pre>
<pre class="r"><code>pi0est_chimps_given_humans &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps_given_humans</code></pre>
<pre><code>[1] 0.8573164</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_chimps_given_humans &lt;- 1 - pi0est_chimps_given_humans
pi1est_chimps_given_humans</code></pre>
<pre><code>[1] 0.1426836</code></pre>
<pre class="r"><code>pi1est_chimps_given_humans*as.data.frame(qqplot_inc_day01[[3]][2])</code></pre>
<pre><code>  qqplot_inc_day01[[3]][2]
1                 12.69884</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_c &lt;- array(&quot;Chimpanzee&quot;, dim = c(10304,1))
labels_h &lt;- array(&quot;Shared (Chimpanzee|Significant in Humans)&quot;, dim = c(as.data.frame(qqplot_inc_day01[[3]][2]),1))

chimps &lt;- cbind(labels_c, chimp_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
humans &lt;- cbind(labels_h, shared_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(chimps[,1:2], humans[,1:2])


p5 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 0 to 1&quot;) +
  geom_hline(yintercept = pi0est_chimps_given_humans) + 
  geom_hline(yintercept = pi0est_chimps) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, chimp&quot;])==&quot;1&quot;&#39;, parse=TRUE, x=0.6, y=(pi0est_chimps+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.86&quot;&#39;, parse=TRUE, x=0.6, y=(pi0est_chimps_given_humans+0.07))

p5</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-9-5.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Day 1 to 2

# Obtain pvalues
chimp_p_values_gen &lt;- as.data.frame(qqplot_inc_day12[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_inc_day12[2])


# Pi_0 estimate for the chimps

pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.5163392

$pi0.lambda
 [1] 0.9983859 0.9877502 0.9749498 0.9539984 0.9288302 0.8956300 0.8640409
 [8] 0.8372153 0.8028656 0.7653339 0.7261473 0.7009414 0.6743567 0.6453804
[15] 0.6184006 0.5924884 0.5784161 0.5619177 0.5124224

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 1.0208717 0.9947111 0.9683624 0.9416093 0.9142774 0.8862865 0.8576620
 [8] 0.8285069 0.7989818 0.7693073 0.7397306 0.7104652 0.6816346 0.6532840
[15] 0.6253970 0.5978963 0.5706499 0.5434979 0.5163392</code></pre>
<pre class="r"><code>pi0est_chimps &lt;- pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps</code></pre>
<pre><code>[1] 0.5163392</code></pre>
<pre class="r"><code># Pi_1 estimate for the chimps

pi1est_chimps &lt;- 1 - pi0est_chimps
pi1est_chimps</code></pre>
<pre><code>[1] 0.4836608</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.3201421

$pi0.lambda
 [1] 0.9841049 0.9577419 0.9305807 0.8890113 0.8497308 0.8111321 0.7522874
 [8] 0.7146353 0.6870467 0.6470876 0.5993365 0.5677925 0.5426194 0.5286344
[15] 0.4718551 0.4160548 0.3752651 0.3573177 0.3328439

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9955374 0.9572632 0.9188987 0.8803715 0.8416835 0.8029083 0.7641847
 [8] 0.7256902 0.6875352 0.6497550 0.6123642 0.5753455 0.5385985 0.5019713
[15] 0.4653583 0.4288093 0.3924274 0.3562335 0.3201421</code></pre>
<pre class="r"><code>pi0est_chimps_given_humans &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps_given_humans</code></pre>
<pre><code>[1] 0.3201421</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_chimps_given_humans &lt;- 1 - pi0est_chimps_given_humans
pi1est_chimps_given_humans</code></pre>
<pre><code>[1] 0.6798579</code></pre>
<pre class="r"><code>pi1est_chimps_given_humans*as.data.frame(qqplot_inc_day12[[3]][2])</code></pre>
<pre><code>  qqplot_inc_day12[[3]][2]
1                  1388.95</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_c &lt;- array(&quot;Chimpanzee&quot;, dim = c(10304,1))
labels_h &lt;- array(&quot;Shared (Chimpanzee|Significant in Humans)&quot;, dim = c(as.data.frame(qqplot_inc_day12[[3]][2]),1))

chimps &lt;- cbind(labels_c, chimp_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
humans &lt;- cbind(labels_h, shared_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(chimps[,1:2], humans[,1:2])


p6 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 1 to 2&quot;) +
  geom_hline(yintercept = pi0est_chimps_given_humans) + 
  geom_hline(yintercept = pi0est_chimps) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, chimp&quot;])==&quot;0.52&quot;&#39;, parse=TRUE, x=0.4, y=(pi0est_chimps+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.32&quot;&#39;, parse=TRUE, x=0.4, y=(pi0est_chimps_given_humans+0.07))

p6</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-9-6.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Day 2 to 3

# Obtain pvalues
chimp_p_values_gen &lt;- as.data.frame(qqplot_inc_day23[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_inc_day23[2])


# Pi_0 estimate for the chimps

pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.3687158

$pi0.lambda
 [1] 1.0055369 1.0135223 1.0085175 0.9999757 0.9868012 0.9627329 0.9327222
 [8] 0.8962539 0.8559783 0.8093944 0.7619479 0.7016693 0.6549468 0.6026786
[15] 0.5516304 0.5099961 0.4664855 0.4027562 0.3668478

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 1.0606286 1.0381333 1.0151671 0.9911197 0.9653244 0.9371815 0.9062506
 [8] 0.8722905 0.8352661 0.7953320 0.7528030 0.7081082 0.6617352 0.6141406
[15] 0.5657213 0.5167857 0.4675432 0.4181471 0.3687158</code></pre>
<pre class="r"><code>pi0est_chimps &lt;- pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps</code></pre>
<pre><code>[1] 0.3687158</code></pre>
<pre class="r"><code># Pi_1 estimate for the chimps

pi1est_chimps &lt;- 1 - pi0est_chimps
pi1est_chimps</code></pre>
<pre><code>[1] 0.6312842</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.2319935

$pi0.lambda
 [1] 0.9751536 0.9390863 0.9226635 0.8914975 0.8730964 0.8629442 0.7965638
 [8] 0.7445008 0.6968159 0.6751269 0.5978567 0.5774112 0.5148658 0.4991540
[15] 0.4873096 0.4441624 0.3384095 0.2284264 0.2030457

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9943680 0.9611998 0.9278494 0.8940105 0.8593165 0.8233989 0.7860113
 [8] 0.7471496 0.7069145 0.6653932 0.6226287 0.5786695 0.5334437 0.4868157
[15] 0.4385654 0.3885786 0.3370895 0.2846939 0.2319935</code></pre>
<pre class="r"><code>pi0est_chimps_given_humans &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps_given_humans</code></pre>
<pre><code>[1] 0.2319935</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_chimps_given_humans &lt;- 1 - pi0est_chimps_given_humans
pi1est_chimps_given_humans</code></pre>
<pre><code>[1] 0.7680065</code></pre>
<pre class="r"><code>pi1est_chimps_given_humans*as.data.frame(qqplot_inc_day12[[3]][2])</code></pre>
<pre><code>  qqplot_inc_day12[[3]][2]
1                 1569.037</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_c &lt;- array(&quot;Chimpanzee&quot;, dim = c(10304,1))
labels_h &lt;- array(&quot;Shared (Chimpanzee|Significant in Humans)&quot;, dim = c(as.data.frame(qqplot_inc_day23[[3]][2]),1))

chimps &lt;- cbind(labels_c, chimp_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
humans &lt;- cbind(labels_h, shared_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(chimps[,1:2], humans[,1:2])


p7 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 2 to 3&quot;) +
  geom_hline(yintercept = pi0est_chimps_given_humans) + 
  geom_hline(yintercept = pi0est_chimps) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, chimp&quot;])==&quot;0.37&quot;&#39;, parse=TRUE, x=0.4, y=(pi0est_chimps+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.23&quot;&#39;, parse=TRUE, x=0.4, y=(pi0est_chimps_given_humans+0.07))

p7</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-9-7.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Day 0 to 2

# Obtain pvalues
chimp_p_values_gen &lt;- as.data.frame(qqplot_inc_day02[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_inc_day02[2])


# Pi_0 estimate for the chimps

pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.9853863

$pi0.lambda
 [1] 0.9817342 0.9735162 0.9627329 0.9513296 0.9440994 0.9408274 0.9352604
 [8] 0.9297360 0.9193252 0.9089674 0.9103261 0.9091130 0.9072760 0.9216486
[15] 0.9258540 0.9321623 0.9562629 0.9918478 1.0326087

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9730344 0.9652529 0.9575516 0.9500612 0.9429530 0.9364129 0.9306407
 [8] 0.9258672 0.9223586 0.9204040 0.9202661 0.9221298 0.9260949 0.9321540
[15] 0.9401686 0.9499008 0.9609989 0.9729923 0.9853863</code></pre>
<pre class="r"><code>pi0est_chimps &lt;- pi0est(chimp_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps</code></pre>
<pre><code>[1] 0.9853863</code></pre>
<pre class="r"><code># Pi_1 estimate for the chimps

pi1est_chimps &lt;- 1 - pi0est_chimps
pi1est_chimps</code></pre>
<pre><code>[1] 0.0146137</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.6227962

$pi0.lambda
 [1] 0.9515910 0.9137217 0.8933086 0.8775072 0.8691500 0.8739255 0.8794358
 [8] 0.8810888 0.8543892 0.8309456 0.8054760 0.7736390 0.7777323 0.7784145
[15] 0.7507163 0.7020057 0.6685769 0.7306590 0.5157593

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9336099 0.9223400 0.9112018 0.9002575 0.8894327 0.8784819 0.8670157
 [8] 0.8546099 0.8409356 0.8258384 0.8092773 0.7912512 0.7717223 0.7505620
[15] 0.7276875 0.7032020 0.6773664 0.6504540 0.6227962</code></pre>
<pre class="r"><code>pi0est_chimps_given_humans &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_chimps_given_humans</code></pre>
<pre><code>[1] 0.6227962</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_chimps_given_humans &lt;- 1 - pi0est_chimps_given_humans
pi1est_chimps_given_humans</code></pre>
<pre><code>[1] 0.3772038</code></pre>
<pre class="r"><code>pi1est_chimps_given_humans*as.data.frame(qqplot_inc_day02[[3]][2])</code></pre>
<pre><code>  qqplot_inc_day02[[3]][2]
1                 263.2882</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_c &lt;- array(&quot;Chimpanzee&quot;, dim = c(10304,1))
labels_h &lt;- array(&quot;Shared (Chimpanzee|Significant in Humans)&quot;, dim = c(as.data.frame(qqplot_inc_day02[[3]][2]),1))

chimps &lt;- cbind(labels_c, chimp_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
humans &lt;- cbind(labels_h, shared_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(chimps[,1:2], humans[,1:2])


p8 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 2 to 3&quot;) +
  geom_hline(yintercept = pi0est_chimps_given_humans) + 
  geom_hline(yintercept = pi0est_chimps) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, chimp&quot;])==&quot;0.99&quot;&#39;, parse=TRUE, x=0.6, y=(pi0est_chimps+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.62&quot;&#39;, parse=TRUE, x=0.6, y=(pi0est_chimps_given_humans+0.07))

p8</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-9-8.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>multiplot(p1,p5,p2,p6,p3,p7,p4,p8,cols=4)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-9-9.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="sharing-estimates-chimps-conditioned-on-humans" class="section level3">
<h3>Sharing estimates (chimps conditioned on humans)</h3>
<pre class="r"><code>find_qqplot_red_top_all_sharing_chimps &lt;- function(chimp_begin_column_tm1, chimp_end_column_tm1, chimp_begin_column_t, chimp_end_column_t, human_begin_column_tm1, human_end_column_tm1, human_begin_column_t, human_end_column_t){

  # Make an array to store the Chimp p-values

  chimp_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,chimp_begin_column_tm1:chimp_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,chimp_begin_column_t:chimp_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;greater&quot;))
    chimp_var_pval[i,1] &lt;- htest$p.value
  }

  hist(chimp_var_pval)

############## For humans

  human_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,human_begin_column_tm1:human_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,human_begin_column_t:human_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;greater&quot;))
    human_var_pval[i,1] &lt;- htest$p.value
  }

  hist(human_var_pval)

############ Find p-values of the F_statistics

# Make one data frame

  var_pval &lt;- as.data.frame(cbind(human_var_pval, chimp_var_pval))
  rownames(var_pval) &lt;- rownames(mean_tech_reps)
  colnames(var_pval) &lt;- c(&quot;Human&quot;, &quot;Chimpanzee&quot;)
  summary(var_pval)

  dim(var_pval)

# Convert to data frame
  top_var_pval &lt;- var_pval[order(var_pval[,1]), ]
  
# Instead of going by p &lt; 0.05, take the top x number of p-values
  for_pi1_var_pval &lt;- array(NA, dim = c(10205, 2))
  
  for(i in 100:10304){
    num_var_pval &lt;- top_var_pval[1:i, 1:2]
  
# Get humans
    num_var_pval_chimps_i &lt;- top_var_pval[1:i, 1]
  
# Get sharing
    num_var_pval_shared_i &lt;- top_var_pval[1:i, 2]
  

# Pi_0 estimate for the humans given significant in the chimps
  pi0est_humans_given_chimps_i &lt;- pi0est(num_var_pval_shared_i, lambda = seq(0.05, 0.95, 0.05))$pi0


# Pi_1 estimate for the humans
  for_pi1_var_pval[i-99,1] &lt;- i
  for_pi1_var_pval[i-99,2] &lt;- 1 - pi0est_humans_given_chimps_i
  }
  return(for_pi1_var_pval)
}

find_qqplot_inc_top_all_sharing_chimps &lt;- function(chimp_begin_column_tm1, chimp_end_column_tm1, chimp_begin_column_t, chimp_end_column_t, human_begin_column_tm1, human_end_column_tm1, human_begin_column_t, human_end_column_t){

  # Make an array to store the Chimp p-values

  chimp_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,chimp_begin_column_tm1:chimp_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,chimp_begin_column_t:chimp_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;less&quot;))
    chimp_var_pval[i,1] &lt;- htest$p.value
  }

  hist(chimp_var_pval)

############## For humans

  human_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,human_begin_column_tm1:human_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,human_begin_column_t:human_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;less&quot;))
    human_var_pval[i,1] &lt;- htest$p.value
  }

  hist(human_var_pval)

############ Find p-values of the F_statistics

# Make one data frame

  var_pval &lt;- as.data.frame(cbind( human_var_pval, chimp_var_pval))
  rownames(var_pval) &lt;- rownames(mean_tech_reps)
  colnames(var_pval) &lt;- c( &quot;Human&quot;, &quot;Chimpanzee&quot;)
  summary(var_pval)

  dim(var_pval)

# Convert to data frame
  top_var_pval &lt;- var_pval[order(var_pval[,1]), ]
  
# Instead of going by p &lt; 0.05, take the top x number of p-values
  for_pi1_var_pval &lt;- array(NA, dim = c(10205, 2))
  
  for(i in 100:10304){
    num_var_pval &lt;- top_var_pval[1:i, 1:2]
  
# Get humans
    num_var_pval_chimps_i &lt;- top_var_pval[1:i, 1]
  
# Get sharing
    num_var_pval_shared_i &lt;- top_var_pval[1:i, 2]
  

# Pi_0 estimate for the humans given significant in the chimps
  pi0est_humans_given_chimps_i &lt;- pi0est(num_var_pval_shared_i, lambda = seq(0.05, 0.95, 0.05))$pi0


# Pi_1 estimate for the humans
  for_pi1_var_pval[i-99,1] &lt;- i
  for_pi1_var_pval[i-99,2] &lt;- 1 - pi0est_humans_given_chimps_i
  }
  return(for_pi1_var_pval)
}

# Reduction in variance from day 0 to day 1

qqplot_red_top_all_day01 &lt;- find_qqplot_red_top_all_sharing_chimps(7,10,17,20,1,6,11,16)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction in variance from day 1 to day 2

qqplot_red_top_all_day12 &lt;- find_qqplot_red_top_all_sharing_chimps(17,20,27,30,11,16,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-3.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction in variance from day 2 to day 3

qqplot_red_top_all_day23 &lt;- find_qqplot_red_top_all_sharing_chimps(27,30,37,40,21,26,31,36)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-5.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-6.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction in variance from day 0 to day 2

qqplot_red_top_all_day02 &lt;- find_qqplot_red_top_all_sharing_chimps(7,10,27,30,1,6,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-7.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-8.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 0 to day 1

qqplot_inc_top_all_day01 &lt;- find_qqplot_inc_top_all_sharing_chimps(7,10,17,20,1,6,11,16)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-9.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-10.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 1 to day 2

qqplot_inc_top_all_day12 &lt;- find_qqplot_inc_top_all_sharing_chimps(17,20,27,30,11,16,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-11.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-12.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 2 to day 3

qqplot_inc_top_all_day23 &lt;- find_qqplot_inc_top_all_sharing_chimps(27,30,37,40,21,26,31,36)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-13.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-14.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 0 to day 2

qqplot_inc_top_all_day02 &lt;- find_qqplot_inc_top_all_sharing_chimps(7,10,27,30,1,6,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-15.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-16.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Make everything a data frame
qqplot_red_top_all_day01 &lt;- as.data.frame(qqplot_red_top_all_day01)
qqplot_red_top_all_day12 &lt;- as.data.frame(qqplot_red_top_all_day12)
qqplot_red_top_all_day23 &lt;- as.data.frame(qqplot_red_top_all_day23)
qqplot_red_top_all_day02 &lt;- as.data.frame(qqplot_red_top_all_day02)
qqplot_inc_top_all_day01 &lt;- as.data.frame(qqplot_inc_top_all_day01)
qqplot_inc_top_all_day12 &lt;- as.data.frame(qqplot_inc_top_all_day12)
qqplot_inc_top_all_day23 &lt;- as.data.frame(qqplot_inc_top_all_day23)
qqplot_inc_top_all_day02 &lt;- as.data.frame(qqplot_inc_top_all_day02)

# Plots of pi_0

qqplot_red_top_all_day01_pi0 &lt;- abs(1- qqplot_red_top_all_day01)
qqplot_red_top_all_day12_pi0 &lt;- abs(1- qqplot_red_top_all_day12)
qqplot_red_top_all_day23_pi0 &lt;- abs(1- qqplot_red_top_all_day23)
qqplot_red_top_all_day02_pi0 &lt;- abs(1- qqplot_red_top_all_day02)
qqplot_inc_top_all_day01_pi0 &lt;- abs(1- qqplot_inc_top_all_day01)
qqplot_inc_top_all_day12_pi0 &lt;- abs(1- qqplot_inc_top_all_day12)
qqplot_inc_top_all_day23_pi0 &lt;- abs(1- qqplot_inc_top_all_day23)
qqplot_inc_top_all_day02_pi0 &lt;- abs(1- qqplot_inc_top_all_day02)

# Plot reduction in variation
ggplot(qqplot_red_top_all_day01_pi0, aes(x = qqplot_red_top_all_day01_pi0[,1], y = qqplot_red_top_all_day01_pi0[,2])) + geom_line(colour=&quot;#E69F00&quot;) + theme_bw() + geom_line(aes(x = qqplot_red_top_all_day12_pi0[,1], y = qqplot_red_top_all_day12_pi0[,2]), colour = &quot;#000000&quot;) + geom_line(aes(x = qqplot_red_top_all_day23_pi0[,1], y = qqplot_red_top_all_day23_pi0[,2]), colour =  &quot;#009E73&quot;) + geom_line(aes(x = qqplot_red_top_all_day02_pi0[,1], y = qqplot_red_top_all_day02_pi0[,2]), colour =  &quot;#0072B2&quot;) + ylim(0,1) + ggtitle(expression( italic(hat(pi)[0]) ~ &quot;For Reduction in Variance Between Days (Chimpanzees|Significant in Humans)&quot; )) + xlab(&quot;N Most Significant Genes in Humans&quot;) + ylab(expression( italic(hat(pi)[0]) ~ &quot;(Chimpanzees|Significant in Humans)&quot;)) 

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = &quot;n&quot;, bty = &quot;n&quot;, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;)
legend(&quot;right&quot;, c(&quot;Day 0 to 1&quot;, &quot;Day 1 to 2&quot;, &quot;Day 2 to 3&quot;, &quot;Day 0 to 2&quot;), xpd = TRUE, horiz = FALSE, inset = c(0, 0), bty = &quot;n&quot;, pch = c(15, 15, 15, 15), col = c(&quot;#E69F00&quot;, &quot;#000000&quot;,  &quot;#009E73&quot;,&quot;#0072B2&quot; ), cex = 1)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-17.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Plot of Increase in Variation

ggplot(qqplot_inc_top_all_day01_pi0, aes(x = qqplot_inc_top_all_day01_pi0[,1], y = qqplot_inc_top_all_day01_pi0[,2])) + geom_line(colour=&quot;#E69F00&quot;) + theme_bw() + geom_line(aes(x = qqplot_inc_top_all_day12_pi0[,1], y = qqplot_inc_top_all_day12_pi0[,2]), colour = &quot;#000000&quot;) + geom_line(aes(x = qqplot_inc_top_all_day23_pi0[,1], y = qqplot_inc_top_all_day23_pi0[,2]), colour =  &quot;#009E73&quot;) + geom_line(aes(x = qqplot_inc_top_all_day02_pi0[,1], y = qqplot_inc_top_all_day02_pi0[,2]), colour =  &quot;#0072B2&quot;) + ylim(0,1) + ggtitle(expression( italic(hat(pi)[0]) ~ &quot;For Increase in Variance Between Days (Chimpanzees|Significant in Humans)&quot; )) + xlab(&quot;N Most Significant Genes in Humans&quot;) + ylab(expression( italic(hat(pi)[0]) ~ &quot;(Chimpanzees|Significant in Humans)&quot;)) 

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = &quot;n&quot;, bty = &quot;n&quot;, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;)
legend(&quot;right&quot;, c(&quot;Day 0 to 1&quot;, &quot;Day 1 to 2&quot;, &quot;Day 2 to 3&quot;, &quot;Day 0 to 2&quot;), xpd = TRUE, horiz = FALSE, inset = c(0, 0), bty = &quot;n&quot;, pch = c(15, 15, 15, 15), col = c(&quot;#E69F00&quot;, &quot;#000000&quot;,  &quot;#009E73&quot;,&quot;#0072B2&quot; ), cex = 1)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-18.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Plots of pi_1

#dev.off()
# Plot reduction in variation
ggplot(qqplot_red_top_all_day01, aes(x = qqplot_red_top_all_day01[,1], y = qqplot_red_top_all_day01[,2])) + geom_line(colour=&quot;#E69F00&quot;) + theme_bw() + geom_line(aes(x = qqplot_red_top_all_day12[,1], y = qqplot_red_top_all_day12[,2]), colour = &quot;#000000&quot;) + geom_line(aes(x = qqplot_red_top_all_day23[,1], y = qqplot_red_top_all_day23[,2]), colour =  &quot;#009E73&quot;) + geom_line(aes(x = qqplot_red_top_all_day02[,1], y = qqplot_red_top_all_day02[,2]), colour =  &quot;#0072B2&quot;) + ylim(0,1) + ggtitle(&quot;Proportion of Shared Genes with a Reduction in Variance between Days&quot;) + xlab(&quot;N Most Significant Genes in Humans&quot;) + ylab(expression( italic(hat(pi)[1]) ~ &quot;(Chimpanzees|Significant in Humans)&quot;)) 

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = &quot;n&quot;, bty = &quot;n&quot;, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;)
legend(&quot;right&quot;, c(&quot;Day 0 to 1&quot;, &quot;Day 1 to 2&quot;, &quot;Day 2 to 3&quot;, &quot;Day 0 to 2&quot;), xpd = TRUE, horiz = FALSE, inset = c(0, 
    0), bty = &quot;n&quot;, pch = c(15, 15, 15, 15), col = c(&quot;#E69F00&quot;, &quot;#000000&quot;,  &quot;#009E73&quot;,&quot;#0072B2&quot; ), cex = 1)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-19.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Plot inc in variation
ggplot(qqplot_inc_top_all_day01, aes(x = qqplot_inc_top_all_day01[,1], y = qqplot_inc_top_all_day01[,2])) + geom_line(colour=&quot;#E69F00&quot;) + theme_bw() + geom_line(aes(x = qqplot_inc_top_all_day12[,1], y = qqplot_inc_top_all_day12[,2]), colour = &quot;#000000&quot;) + geom_line(aes(x = qqplot_inc_top_all_day23[,1], y = qqplot_inc_top_all_day23[,2]), colour =  &quot;#009E73&quot;) + geom_line(aes(x = qqplot_inc_top_all_day02[,1], y = qqplot_inc_top_all_day02[,2]), colour =  &quot;#0072B2&quot;) + ylim(0,1) + ggtitle(&quot;Proportion of Shared Genes with an Increase in Variance between Days&quot;) + xlab(&quot;N Most Significant Genes in Humans&quot;) + ylab(expression( italic(hat(pi)[1]) ~ &quot;(Chimpanzees|Significant in Humans)&quot;)) 
 

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = &quot;n&quot;, bty = &quot;n&quot;, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;)
legend(&quot;right&quot;, c(&quot;Day 0 to 1&quot;, &quot;Day 1 to 2&quot;, &quot;Day 2 to 3&quot;, &quot;Day 0 to 2&quot;), xpd = TRUE, horiz = FALSE, inset = c(0, 
    0), bty = &quot;n&quot;, pch = c(15, 15, 15, 15), col = c(&quot;#E69F00&quot;, &quot;#000000&quot;,  &quot;#009E73&quot;,&quot;#0072B2&quot; ), cex = 1)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-20.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(qqplot_inc_top_all_day01, aes(x = qqplot_inc_top_all_day01[,1], y = qqplot_inc_top_all_day01[,2])) + geom_line(colour=&quot;#E69F00&quot;) + theme_bw() + geom_line(aes(x = qqplot_inc_top_all_day12[,1], y = qqplot_inc_top_all_day12[,2]), colour = &quot;#000000&quot;) + geom_line(aes(x = qqplot_inc_top_all_day23[,1], y = qqplot_inc_top_all_day23[,2]), colour =  &quot;#009E73&quot;) + geom_line(aes(x = qqplot_inc_top_all_day02[,1], y = qqplot_inc_top_all_day02[,2]), colour =  &quot;#0072B2&quot;) + ylim(0,1) + ggtitle(&quot;Proportion of Shared Genes with an Increase in Variance between Days&quot;) + xlab(&quot;N Most Significant Genes in Humans&quot;) + ylab(expression( italic(hat(pi)[1]) ~ &quot;(Chimpanzees|Significant in Humans)&quot;)) </code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-10-21.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="enrichments-in-humans" class="section level3">
<h3>Enrichments in humans</h3>
<pre class="r"><code># Reduction in variance from day 0 to day 1 humans

qqplot_red_day01 &lt;- find_qqplot_red_humans(7,10,17,20,1,6,11,16)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction in variance from day 1 to day 2 humans

qqplot_red_day12 &lt;- find_qqplot_red_humans(17,20,27,30,11,16,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-3.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction in variance from day 2 to day 3 humans

qqplot_red_day23 &lt;- find_qqplot_red_humans(27,30,37,40,21,26,31,36)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-5.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-6.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction in variance from day 0 to day 2 humans

qqplot_red_day02 &lt;- find_qqplot_red_humans(7,10,27,30,1,6,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-7.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-8.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 0 to day 1 humans

qqplot_inc_day01 &lt;- find_qqplot_inc_humans(7,10,17,20,1,6,11,16)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-9.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-10.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 1 to day 2 humans

qqplot_inc_day12 &lt;- find_qqplot_inc_humans(17,20,27,30,11,16,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-11.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-12.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 2 to day 3 humans

qqplot_inc_day23 &lt;- find_qqplot_inc_humans(27,30,37,40,21,26,31,36)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-13.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-14.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 0 to day 2

qqplot_inc_day02 &lt;- find_qqplot_inc_humans(7,10,27,30,1,6,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-15.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-11-16.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction of variance qqplots- humans

dev.off()</code></pre>
<pre><code>null device 
          1 </code></pre>
<pre class="r"><code>par(mfrow=c(2,4),oma = c(2, 2, 2, 2))

# Reduction of variance to day 0 to 1 humans
plot(qqplot_red_day01[[4]],qqplot_red_day01[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;, main = &quot;Day 0 to 1&quot;)
abline(0,1, col = &quot;black&quot;)

# Add to the plot
points(qqplot_red_day01[[6]],qqplot_red_day01[[7]], pch = 16, col = pal[3])

# Reduction of variance to day 1 to 2
plot(qqplot_red_day12[[4]],qqplot_red_day12[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;, main = &quot;Day 1 to 2&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_red_day12[[6]],qqplot_red_day12[[7]], pch = 16, col = pal[3])

# Reduction of variance to day 2 to 3
plot(qqplot_red_day23[[4]],qqplot_red_day23[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;, main = &quot;Day 2 to 3&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_red_day23[[6]],qqplot_red_day23[[7]], pch = 16, col = pal[3])

# Reduction of variance to day 0 to 2
plot(qqplot_red_day02[[4]],qqplot_red_day02[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;, main = &quot;Day 0 to 2&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_red_day02[[6]],qqplot_red_day02[[7]], pch = 16, col = pal[3])

# Add bottom title

mtext(&quot;Reduction in Variation&quot;, font = 2, side = 3, line = -1.5, outer = TRUE)

### Increase in variance

# Inc variance to day 0 to 1
plot(qqplot_inc_day01[[4]],qqplot_inc_day01[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;,  main = &quot;Day 0 to 1&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_inc_day01[[6]],qqplot_inc_day01[[7]], pch = 16, col = pal[3])

# Increase of variance to day 1 to 2
plot(qqplot_inc_day12[[4]],qqplot_inc_day12[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;,  main = &quot;Day 1 to 2&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_inc_day12[[6]],qqplot_inc_day12[[7]], pch = 16, col = pal[3])


# Increase of variance to day 2 to 3
plot(qqplot_inc_day23[[4]],qqplot_inc_day23[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;,  main = &quot;Day 2 to 3&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_inc_day23[[6]],qqplot_inc_day23[[7]], pch = 16, col = pal[3])

# Increase of variance to day 0 to 2
plot(qqplot_inc_day02[[4]],qqplot_inc_day02[[5]], pch = 16, xlim = c(0,6), ylim = c(0,6), col = pal[2], xlab = &quot;-log10(p) Expected&quot;, ylab = &quot;-log10(p) Obeserved&quot;,  main = &quot;Day 0 to 2&quot;)
abline(0,1, col = &quot;black&quot;)


# Add to the plot
points(qqplot_inc_day02[[6]],qqplot_inc_day02[[7]], pch = 16, col = pal[3])


mtext(&quot;Increase in Variation&quot;, font = 2, side = 3, line = -29, outer = TRUE)

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = &quot;n&quot;, bty = &quot;n&quot;, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;)
legend(&quot;bottomright&quot;, c(&quot;Human&quot;, &quot;Human|significant in chimpanzee&quot;), xpd = TRUE, horiz = TRUE, inset = c(0,  0), bty = &quot;n&quot;, pch = c(16, 16), col = pal[2:3], cex = 1.5)</code></pre>
<pre class="r"><code>################ REDUCTION IN VARIATION FOR HUMANS ################

# Day 0 to 1

# Obtain pvalues
human_p_values_gen &lt;- as.data.frame(qqplot_red_day01[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_red_day01[2])


# Pi_0 estimate for the chimps

pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.1731401

$pi0.lambda
 [1] 0.8187929 0.7324017 0.6693003 0.6214819 0.5782867 0.5391803 0.5043598
 [8] 0.4774845 0.4473108 0.4132376 0.3830228 0.3622380 0.3410603 0.3115295
[15] 0.2841615 0.2620342 0.2283903 0.2057453 0.1727484

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.7648192 0.7215064 0.6786375 0.6367018 0.5961333 0.5572493 0.5202282
 [8] 0.4851080 0.4518082 0.4201811 0.3900358 0.3611291 0.3331731 0.3058869
[15] 0.2790402 0.2524500 0.2259809 0.1995579 0.1731401</code></pre>
<pre class="r"><code>pi0est_humans &lt;- pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans</code></pre>
<pre><code>[1] 0.1731401</code></pre>
<pre class="r"><code># Pi_1 estimate for the chimps

pi1est_humans &lt;- 1 - pi0est_humans
pi1est_humans</code></pre>
<pre><code>[1] 0.8268599</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.1199522

$pi0.lambda
 [1] 0.7791538 0.6790123 0.6151480 0.5616830 0.5098039 0.4715219 0.4223228
 [8] 0.3976035 0.3713607 0.3137255 0.3013798 0.2696078 0.2614379 0.2342048
[15] 0.2287582 0.2042484 0.1633987 0.1470588 0.1307190

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.7155719 0.6674641 0.6198775 0.5733882 0.5285472 0.4858122 0.4455069
 [8] 0.4078237 0.3727995 0.3403843 0.3104717 0.2827998 0.2570057 0.2326502
[15] 0.2093023 0.1865709 0.1641937 0.1420268 0.1199522</code></pre>
<pre class="r"><code>pi0est_humans_given_chimps &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans_given_chimps</code></pre>
<pre><code>[1] 0.1199522</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans_given_chimps &lt;- 1 - pi0est_humans_given_chimps
pi1est_humans_given_chimps</code></pre>
<pre><code>[1] 0.8800478</code></pre>
<pre class="r"><code>pi0est_humans_given_chimps*as.data.frame(qqplot_red_day01[[3]][2])</code></pre>
<pre><code>  qqplot_red_day01[[3]][2]
1                 274.5705</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_h &lt;- array(&quot;Humans&quot;, dim = c(10304,1))
labels_c &lt;- array(&quot;Shared (Human|Significant in Chimps)&quot;, dim = c(as.data.frame(qqplot_red_day01[[3]][1]),1))

humans &lt;- cbind(labels_h, human_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
chimps &lt;- cbind(labels_c, shared_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(humans[,1:2], chimps[,1:2])


p1 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 0 to 1&quot;) +
  geom_hline(yintercept = pi0est_humans_given_chimps) + 
  geom_hline(yintercept = pi0est_humans) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, human&quot;])==&quot;0.17&quot;&#39;, parse=TRUE, x=0.3, y=(pi0est_humans+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.12&quot;&#39;, parse=TRUE, x=0.3, y=(pi0est_humans_given_chimps-0.06))

p1</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Day 1 to 2

# Obtain pvalues
human_p_values_gen &lt;- as.data.frame(qqplot_red_day12[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_red_day12[2])


# Pi_0 estimate for the humans

pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 1

$pi0.lambda
 [1] 1.039453 1.083937 1.126461 1.175393 1.226967 1.283274 1.346303
 [8] 1.412882 1.480802 1.559977 1.653942 1.763635 1.883041 2.027368
[15] 2.192547 2.416052 2.658514 3.088121 3.965450

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9721921 1.0255975 1.0796152 1.1352295 1.1938033 1.2570192 1.3268234
 [8] 1.4053712 1.4949662 1.5979588 1.7165839 1.8527730 2.0079568 2.1828446
[15] 2.3771586 2.5893862 2.8165989 3.0544949 3.2977478</code></pre>
<pre class="r"><code>pi0est_humans &lt;- pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans &lt;- 1 - pi0est_humans
pi1est_humans</code></pre>
<pre><code>[1] 0</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 1

$pi0.lambda
 [1] 1.028708 1.035354 1.060606 1.103220 1.151515 1.190476 1.252914
 [8] 1.262626 1.329201 1.378788 1.439394 1.515152 1.601732 1.654040
[15] 1.681818 1.799242 1.792929 2.121212 2.575758

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9805576 1.0192771 1.0584010 1.0984219 1.1398719 1.1833266 1.2294395
 [8] 1.2789485 1.3327039 1.3914959 1.4560574 1.5270276 1.6049242 1.6901759
[15] 1.7831308 1.8838068 1.9915242 2.1047575 2.2208364</code></pre>
<pre class="r"><code>pi0est_humans_given_chimps &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans_given_chimps</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans_given_chimps &lt;- 1 - pi0est_humans_given_chimps
pi1est_humans_given_chimps</code></pre>
<pre><code>[1] 0</code></pre>
<pre class="r"><code>pi1est_humans_given_chimps*as.data.frame(qqplot_red_day12[[3]][2])</code></pre>
<pre><code>  qqplot_red_day12[[3]][2]
1                        0</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_h &lt;- array(&quot;Humans&quot;, dim = c(10304,1))
labels_c &lt;- array(&quot;Shared (Human|Significant in Chimps)&quot;, dim = c(as.data.frame(qqplot_red_day12[[3]][1]),1))

humans &lt;- cbind(labels_h, human_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
chimps &lt;- cbind(labels_c, shared_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(humans[,1:2], chimps[,1:2])


p2 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 1 to 2&quot;) +
  geom_hline(yintercept = pi0est_humans_given_chimps) + 
  geom_hline(yintercept = pi0est_humans) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, human&quot;])==&quot;1&quot;&#39;, parse=TRUE, x=0.25, y=(pi0est_humans+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;1&quot;&#39;, parse=TRUE, x=0.25, y=(pi0est_humans_given_chimps-0.07))

p2</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-12-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Day 2 to 3

# Obtain pvalues
human_p_values_gen &lt;- as.data.frame(qqplot_red_day23[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_red_day23[2])


# Pi_0 estimate for the humans

pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.8725965

$pi0.lambda
 [1] 1.0039024 1.0141693 1.0249589 1.0330939 1.0485248 1.0528505 1.0594840
 [8] 1.0652821 1.0735460 1.0753106 1.0750949 1.0673040 1.0528505 1.0494306
[15] 1.0174689 0.9933036 0.9413820 0.8880047 0.7647516

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 1.0197209 1.0282549 1.0366444 1.0446546 1.0519549 1.0581331 1.0627365
 [8] 1.0652757 1.0652370 1.0621132 1.0554588 1.0449357 1.0303565 1.0117089
[15] 0.9891792 0.9632212 0.9345289 0.9040023 0.8725965</code></pre>
<pre class="r"><code>pi0est_humans &lt;- pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans</code></pre>
<pre><code>[1] 0.8725965</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans &lt;- 1 - pi0est_humans
pi1est_humans</code></pre>
<pre><code>[1] 0.1274035</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.7116312

$pi0.lambda
 [1] 1.0025063 1.0288066 1.0084034 1.0185185 1.0511464 1.0657596 1.0663411
 [8] 1.0846561 1.1063011 1.0793651 1.1052322 1.0978836 1.0582011 1.1111111
[15] 0.9947090 1.0052910 0.9876543 0.6878307 0.4232804

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 1.0177770 1.0304929 1.0430851 1.0553750 1.0669488 1.0771304 1.0850957
 [8] 1.0899148 1.0905359 1.0858755 1.0749182 1.0566751 1.0303640 0.9954986
[15] 0.9519478 0.9002880 0.8416143 0.7778294 0.7116312</code></pre>
<pre class="r"><code>pi0est_humans_given_chimps &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans_given_chimps</code></pre>
<pre><code>[1] 0.7116312</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans_given_chimps &lt;- 1 - pi0est_humans_given_chimps
pi1est_humans_given_chimps</code></pre>
<pre><code>[1] 0.2883688</code></pre>
<pre class="r"><code>pi1est_humans_given_chimps*as.data.frame(qqplot_red_day23[[3]][2])</code></pre>
<pre><code>  qqplot_red_day23[[3]][2]
1                 137.5519</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_h &lt;- array(&quot;Humans&quot;, dim = c(10304,1))
labels_c &lt;- array(&quot;Shared (Human|Significant in Chimps)&quot;, dim = c(as.data.frame(qqplot_red_day23[[3]][1]),1))

humans &lt;- cbind(labels_h, human_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
chimps &lt;- cbind(labels_c, shared_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(humans[,1:2], chimps[,1:2])


p3 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 2 to 3&quot;) +
  geom_hline(yintercept = pi0est_humans_given_chimps) + 
  geom_hline(yintercept = pi0est_humans) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, human&quot;])==&quot;0.87&quot;&#39;, parse=TRUE, x=0.63, y=(pi0est_humans+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.71&quot;&#39;, parse=TRUE, x=0.63, y=(pi0est_humans_given_chimps+0.07))

p3</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-12-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Day 0 to 2

# Obtain pvalues
human_p_values_gen &lt;- as.data.frame(qqplot_red_day02[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_red_day02[2])


# Pi_0 estimate for the humans

pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 1

$pi0.lambda
 [1] 0.9818364 0.9619781 0.9425237 0.9298573 0.9218427 0.9207243 0.9194338
 [8] 0.9229425 0.9315006 0.9423525 0.9491460 0.9525427 0.9577418 0.9740554
[15] 1.0065994 1.0321234 1.0778986 1.1946817 1.3548137

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9474969 0.9412284 0.9352605 0.9300138 0.9259745 0.9236321 0.9234504
 [8] 0.9258666 0.9312892 0.9401058 0.9527044 0.9694807 0.9907916 1.0168560
[15] 1.0476381 1.0827769 1.1215698 1.1629330 1.2055260</code></pre>
<pre class="r"><code>pi0est_humans &lt;- pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans &lt;- 1 - pi0est_humans
pi1est_humans</code></pre>
<pre><code>[1] 0</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.7215477

$pi0.lambda
 [1] 0.8982984 0.8583960 0.8204334 0.7918233 0.7819549 0.7760473 0.7807981
 [8] 0.7706767 0.7518797 0.7669173 0.7268170 0.7330827 0.7089151 0.7205514
[15] 0.7894737 0.7330827 0.7142857 0.7894737 0.6766917

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.8592764 0.8437238 0.8285012 0.8140056 0.8005813 0.7884196 0.7775671
 [8] 0.7679843 0.7596361 0.7524957 0.7465177 0.7416972 0.7379319 0.7350098
[15] 0.7325339 0.7300677 0.7274617 0.7246402 0.7215477</code></pre>
<pre class="r"><code>pi0est_humans_given_chimps &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans_given_chimps</code></pre>
<pre><code>[1] 0.7215477</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans_given_chimps &lt;- 1 - pi0est_humans_given_chimps
pi1est_humans_given_chimps</code></pre>
<pre><code>[1] 0.2784523</code></pre>
<pre class="r"><code>pi1est_humans_given_chimps*as.data.frame(qqplot_red_day02[[3]][2])</code></pre>
<pre><code>  qqplot_red_day02[[3]][2]
1                 192.9674</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_h &lt;- array(&quot;Humans&quot;, dim = c(10304,1))
labels_c &lt;- array(&quot;Shared (Human|Significant in Chimps)&quot;, dim = c(as.data.frame(qqplot_red_day02[[3]][1]),1))

humans &lt;- cbind(labels_h, human_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
chimps &lt;- cbind(labels_c, shared_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(humans[,1:2], chimps[,1:2])


p4 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 0 to 2&quot;) +
  geom_hline(yintercept = pi0est_humans_given_chimps) + 
  geom_hline(yintercept = pi0est_humans) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, human&quot;])==&quot;1&quot;&#39;, parse=TRUE, x=0.5, y=(pi0est_humans+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.72&quot;&#39;, parse=TRUE, x=0.5, y=(pi0est_humans_given_chimps+0.07))

p4</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-12-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>################ INCREASE IN VARIATION FOR HUMANS ################

# Day 0 to 1

# Obtain pvalues
human_p_values_gen &lt;- as.data.frame(qqplot_inc_day01[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_inc_day01[2])


# Pi_0 estimate for the chimps

pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 1

$pi0.lambda
 [1] 1.043540 1.088251 1.136166 1.184491 1.238613 1.295059 1.354814
 [8] 1.425175 1.504800 1.586762 1.675509 1.783773 1.920475 2.075246
[15] 2.265140 2.514072 2.873965 3.408385 4.442935

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9685629 1.0219119 1.0759452 1.1317791 1.1910072 1.2556454 1.3280848
 [8] 1.4110236 1.5073731 1.6201517 1.7523387 1.9066308 2.0851102 2.2888872
[15] 2.5177527 2.7698110 3.0412039 3.3261599 3.6177899</code></pre>
<pre class="r"><code>pi0est_humans &lt;- pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="r"><code># Pi_1 estimate for the chimps

pi1est_humans &lt;- 1 - pi0est_humans
pi1est_humans</code></pre>
<pre><code>[1] 0</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 1

$pi0.lambda
 [1] 1.028768 1.069130 1.099422 1.124055 1.178841 1.223462 1.247820
 [8] 1.288833 1.351042 1.365239 1.472152 1.530227 1.640878 1.763224
[15] 1.904282 2.027708 2.283795 2.544081 3.173804

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9846485 1.0221798 1.0601243 1.0991964 1.1404142 1.1850308 1.2345869
 [8] 1.2908957 1.3558888 1.4314979 1.5195385 1.6214054 1.7380332 1.8696812
[15] 2.0158314 2.1751241 2.3452717 2.5229746 2.7044399</code></pre>
<pre class="r"><code>pi0est_humans_given_chimps &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans_given_chimps</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans_given_chimps &lt;- 1 - pi0est_humans_given_chimps
pi1est_humans_given_chimps</code></pre>
<pre><code>[1] 0</code></pre>
<pre class="r"><code>pi1est_humans_given_chimps*as.data.frame(qqplot_inc_day01[[3]][2])</code></pre>
<pre><code>  qqplot_inc_day01[[3]][2]
1                        0</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_h &lt;- array(&quot;Humans&quot;, dim = c(10304,1))
labels_c &lt;- array(&quot;Shared (Human|Significant in Chimps)&quot;, dim = c(as.data.frame(qqplot_inc_day01[[3]][1]),1))

humans &lt;- cbind(labels_h, human_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
chimps &lt;- cbind(labels_c, shared_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(humans[,1:2], chimps[,1:2])


p5 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 0 to 1&quot;) +
  geom_hline(yintercept = pi0est_humans_given_chimps) + 
  geom_hline(yintercept = pi0est_humans) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, human&quot;])==&quot;1&quot;&#39;, parse=TRUE, x=0.2, y=(pi0est_humans+0.08)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;1&quot;&#39;, parse=TRUE, x=0.2, y=(pi0est_humans_given_chimps-0.07))

p5</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-12-5.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Day 1 to 2

# Obtain pvalues
human_p_values_gen &lt;- as.data.frame(qqplot_inc_day12[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_inc_day12[2])


# Pi_0 estimate for the humans

pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.229162

$pi0.lambda
 [1] 0.8439237 0.7679865 0.7073210 0.6459870 0.6024845 0.5596994 0.5245162
 [8] 0.4909097 0.4649562 0.4400233 0.4123533 0.3806774 0.3568656 0.3390269
[15] 0.3190994 0.2984278 0.2833851 0.2445652 0.2503882

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.7941718 0.7493996 0.7050477 0.6616385 0.6197099 0.5796971 0.5418968
 [8] 0.5064535 0.4733725 0.4425424 0.4137831 0.3868884 0.3616326 0.3377490
[15] 0.3149391 0.2929104 0.2714012 0.2502009 0.2291620</code></pre>
<pre class="r"><code>pi0est_humans &lt;- pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans</code></pre>
<pre><code>[1] 0.229162</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans &lt;- 1 - pi0est_humans
pi1est_humans</code></pre>
<pre><code>[1] 0.770838</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.1090344

$pi0.lambda
 [1] 0.7889781 0.6758736 0.5959898 0.5296610 0.4821092 0.4358354 0.4085180
 [8] 0.3860640 0.3287108 0.2975518 0.2427286 0.2118644 0.1937046 0.2008788
[15] 0.1958569 0.1883239 0.1883239 0.1318267 0.1129944

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.7103323 0.6574410 0.6051998 0.5543446 0.5055540 0.4593322 0.4159955
 [8] 0.3756942 0.3385218 0.3046038 0.2740179 0.2467503 0.2225652 0.2009623
[15] 0.1812416 0.1626837 0.1446809 0.1268386 0.1090344</code></pre>
<pre class="r"><code>pi0est_humans_given_chimps &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans_given_chimps</code></pre>
<pre><code>[1] 0.1090344</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans_given_chimps &lt;- 1 - pi0est_humans_given_chimps
pi1est_humans_given_chimps</code></pre>
<pre><code>[1] 0.8909656</code></pre>
<pre class="r"><code>pi1est_humans_given_chimps*as.data.frame(qqplot_inc_day12[[3]][2])</code></pre>
<pre><code>  qqplot_inc_day12[[3]][2]
1                 1820.243</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_h &lt;- array(&quot;Humans&quot;, dim = c(10304,1))
labels_c &lt;- array(&quot;Shared (Human|Significant in Chimps)&quot;, dim = c(as.data.frame(qqplot_inc_day12[[3]][1]),1))

humans &lt;- cbind(labels_h, human_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
chimps &lt;- cbind(labels_c, shared_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(humans[,1:2], chimps[,1:2])


p6 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 1 to 2&quot;) +
  geom_hline(yintercept = pi0est_humans_given_chimps) + 
  geom_hline(yintercept = pi0est_humans) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, human&quot;])==&quot;0.23&quot;&#39;, parse=TRUE, x=0.25, y=(pi0est_humans+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.11&quot;&#39;, parse=TRUE, x=0.25, y=(pi0est_humans_given_chimps+0.07))

p6</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-12-6.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Day 2 to 3

# Obtain pvalues
human_p_values_gen &lt;- as.data.frame(qqplot_inc_day23[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_inc_day23[2])


# Pi_0 estimate for the humans

pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.8704978

$pi0.lambda
 [1] 1.0123815 1.0124439 1.0103444 1.0016741 0.9941770 0.9788154 0.9715420
 [8] 0.9551307 0.9385587 0.9246894 0.9101104 0.9020769 0.8895297 0.8766822
[15] 0.8544255 0.8676242 0.8585663 0.8724767 0.9258540

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 1.0253972 1.0151115 1.0047187 0.9941050 0.9831929 0.9719673 0.9604901
 [8] 0.9488891 0.9373679 0.9261795 0.9155894 0.9058498 0.8971765 0.8897481
[15] 0.8836803 0.8789705 0.8754287 0.8727432 0.8704978</code></pre>
<pre class="r"><code>pi0est_humans &lt;- pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans</code></pre>
<pre><code>[1] 0.8704978</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans &lt;- 1 - pi0est_humans
pi1est_humans</code></pre>
<pre><code>[1] 0.1295022</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.7509825

$pi0.lambda
 [1] 0.9864140 0.9761388 0.9595508 0.9354664 0.9255242 0.9079641 0.9144001
 [8] 0.9182936 0.9071189 0.8590022 0.8580381 0.8188720 0.8057019 0.7736804
[15] 0.7548807 0.8026030 0.7519884 0.7158351 0.8242950

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9870672 0.9734138 0.9597587 0.9461147 0.9324826 0.9187976 0.9049292
 [8] 0.8906929 0.8759766 0.8608683 0.8456559 0.8306744 0.8163070 0.8028761
[15] 0.7905939 0.7794562 0.7692610 0.7598592 0.7509825</code></pre>
<pre class="r"><code>pi0est_humans_given_chimps &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans_given_chimps</code></pre>
<pre><code>[1] 0.7509825</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans_given_chimps &lt;- 1 - pi0est_humans_given_chimps
pi1est_humans_given_chimps</code></pre>
<pre><code>[1] 0.2490175</code></pre>
<pre class="r"><code>pi1est_humans_given_chimps*as.data.frame(qqplot_inc_day23[[3]][2])</code></pre>
<pre><code>  qqplot_inc_day23[[3]][2]
1                 98.11289</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_h &lt;- array(&quot;Humans&quot;, dim = c(10304,1))
labels_c &lt;- array(&quot;Shared (Human|Significant in Chimps)&quot;, dim = c(as.data.frame(qqplot_inc_day23[[3]][1]),1))

humans &lt;- cbind(labels_h, human_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
chimps &lt;- cbind(labels_c, shared_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(humans[,1:2], chimps[,1:2])


p7 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 2 to 3&quot;) +
  geom_hline(yintercept = pi0est_humans_given_chimps) + 
  geom_hline(yintercept = pi0est_humans) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, human&quot;])==&quot;0.87&quot;&#39;, parse=TRUE, x=0.45, y=(pi0est_humans+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.75&quot;&#39;, parse=TRUE, x=0.45, y=(pi0est_humans_given_chimps+0.07))

p7</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-12-7.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Day 0 to 2

# Obtain pvalues
human_p_values_gen &lt;- as.data.frame(qqplot_inc_day02[1])
shared_p_values_gen &lt;- as.data.frame(qqplot_inc_day02[2])


# Pi_0 estimate for the humans

pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 1

$pi0.lambda
 [1] 0.9813256 0.9783687 0.9862532 0.9919691 0.9978002 1.0111191 1.0227544
 [8] 1.0316382 1.0416078 1.0576475 1.0837215 1.1155862 1.1496229 1.1849767
[15] 1.2344720 1.2805707 1.3256988 1.3421972 1.3451087

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9568239 0.9668100 0.9770063 0.9876967 0.9992351 1.0120083 1.0264003
 [8] 1.0427832 1.0614942 1.0827800 1.1067337 1.1332583 1.1620778 1.1927756
[15] 1.2248351 1.2576947 1.2908638 1.3240323 1.3571293</code></pre>
<pre class="r"><code>pi0est_humans &lt;- pi0est(human_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans</code></pre>
<pre><code>[1] 1</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans &lt;- 1 - pi0est_humans
pi1est_humans</code></pre>
<pre><code>[1] 0</code></pre>
<pre class="r"><code># Pi_0 estimate for the chimps given significant in the humans
pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))</code></pre>
<pre><code>$pi0
[1] 0.8898027

$pi0.lambda
 [1] 0.9510086 0.9478066 0.9476182 0.9311960 0.9260327 0.9304240 0.9044558
 [8] 0.9053794 0.8986115 0.9135447 0.9349984 0.9149856 0.9263071 0.9510086
[15] 0.9682997 0.9654179 0.9798271 0.8933718 0.7780980

$lambda
 [1] 0.05 0.10 0.15 0.20 0.25 0.30 0.35 0.40 0.45 0.50 0.55 0.60 0.65 0.70
[15] 0.75 0.80 0.85 0.90 0.95

$pi0.smooth
 [1] 0.9439400 0.9404434 0.9370127 0.9337672 0.9308885 0.9285524 0.9269079
 [8] 0.9260778 0.9260409 0.9265998 0.9273671 0.9278597 0.9276008 0.9260535
[15] 0.9226902 0.9171743 0.9095084 0.9001044 0.8898027</code></pre>
<pre class="r"><code>pi0est_humans_given_chimps &lt;- pi0est(shared_p_values_gen, lambda = seq(0.05, 0.95, 0.05))$pi0
pi0est_humans_given_chimps</code></pre>
<pre><code>[1] 0.8898027</code></pre>
<pre class="r"><code># Pi_1 estimate for the humans

pi1est_humans_given_chimps &lt;- 1 - pi0est_humans_given_chimps
pi1est_humans_given_chimps</code></pre>
<pre><code>[1] 0.1101973</code></pre>
<pre class="r"><code>pi1est_humans_given_chimps*as.data.frame(qqplot_inc_day02[[3]][2])</code></pre>
<pre><code>  qqplot_inc_day02[[3]][2]
1                 76.91769</code></pre>
<pre class="r"><code># Let&#39;s overlap the two histograms

#abline(1,0)
#hist(num_var_pval_human_given_chimp[,1], breaks = 20, col=rgb(0,0,1,0.5), freq = FALSE)
#hist(var_pval[,1], col=rgb(1,0,0,0.5),  breaks = 20, freq = FALSE, add = T)


labels_h &lt;- array(&quot;Humans&quot;, dim = c(10304,1))
labels_c &lt;- array(&quot;Shared (Human|Significant in Chimps)&quot;, dim = c(as.data.frame(qqplot_inc_day02[[3]][1]),1))

humans &lt;- cbind(labels_h, human_p_values_gen)
colnames(humans) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)
chimps &lt;- cbind(labels_c, shared_p_values_gen)
colnames(chimps) &lt;- c(&quot;Species&quot;, &quot;pval&quot;)

# Combine the two

all_pval &lt;- rbind(humans[,1:2], chimps[,1:2])


p8 &lt;- ggplot(all_pval, aes(pval, fill = Species)) + scale_fill_manual(values=pal[2:3]) +
  geom_density(show.legend = F, alpha = 0.5) +
  scale_x_continuous(limits = c(0,1), breaks = seq(0,1,0.25)) +
  theme_minimal() +  labs(title = &quot;Day 0 to 2&quot;) +
  geom_hline(yintercept = pi0est_humans_given_chimps) + 
  geom_hline(yintercept = pi0est_humans) +       
  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, human&quot;])==&quot;1&quot;&#39;, parse=TRUE, x=0.6, y=(pi0est_humans+0.07)) +  annotate(&quot;text&quot;, label=&#39;italic(hat(pi)[0][&quot;, shared&quot;])==&quot;0.89&quot;&#39;, parse=TRUE, x=0.6, y=(pi0est_humans_given_chimps+0.07))

p8</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-12-8.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>multiplot(p1,p5,p2,p6,p3,p7,p4,p8,cols=4)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-12-9.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="sharing-estimates-humans-conditioned-on-chimps" class="section level3">
<h3>Sharing estimates (humans conditioned on chimps)</h3>
<pre class="r"><code>find_qqplot_red_top_all &lt;- function(chimp_begin_column_tm1, chimp_end_column_tm1, chimp_begin_column_t, chimp_end_column_t, human_begin_column_tm1, human_end_column_tm1, human_begin_column_t, human_end_column_t){

  # Make an array to store the Chimp p-values

  chimp_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,chimp_begin_column_tm1:chimp_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,chimp_begin_column_t:chimp_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;greater&quot;))
    chimp_var_pval[i,1] &lt;- htest$p.value
  }

  hist(chimp_var_pval)

############## For humans

  human_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,human_begin_column_tm1:human_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,human_begin_column_t:human_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;greater&quot;))
    human_var_pval[i,1] &lt;- htest$p.value
  }

  hist(human_var_pval)

############ Find p-values of the F_statistics

# Make one data frame

  var_pval &lt;- as.data.frame(cbind(chimp_var_pval, human_var_pval))
  rownames(var_pval) &lt;- rownames(mean_tech_reps)
  colnames(var_pval) &lt;- c(&quot;Chimpanzee&quot;, &quot;Human&quot;)
  summary(var_pval)

  dim(var_pval)

# Convert to data frame
  top_var_pval &lt;- var_pval[order(var_pval[,1]), ]
  
# Instead of going by p &lt; 0.05, take the top x number of p-values
  for_pi1_var_pval &lt;- array(NA, dim = c(10205, 2))
  
  for(i in 100:10304){
    num_var_pval &lt;- top_var_pval[1:i, 1:2]
  
# Get chimps
    num_var_pval_chimps_i &lt;- top_var_pval[1:i, 1]
  
# Get sharing
    num_var_pval_shared_i &lt;- top_var_pval[1:i, 2]
  

# Pi_0 estimate for the humans given significant in the chimps
  pi0est_humans_given_chimps_i &lt;- pi0est(num_var_pval_shared_i, lambda = seq(0.05, 0.95, 0.05))$pi0


# Pi_1 estimate for the humans
  for_pi1_var_pval[i-99,1] &lt;- i
  for_pi1_var_pval[i-99,2] &lt;- 1 - pi0est_humans_given_chimps_i
  }
  return(for_pi1_var_pval)
}

find_qqplot_inc_top_all &lt;- function(chimp_begin_column_tm1, chimp_end_column_tm1, chimp_begin_column_t, chimp_end_column_t, human_begin_column_tm1, human_end_column_tm1, human_begin_column_t, human_end_column_t){

  # Make an array to store the Chimp p-values

  chimp_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,chimp_begin_column_tm1:chimp_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,chimp_begin_column_t:chimp_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;less&quot;))
    chimp_var_pval[i,1] &lt;- htest$p.value
  }

  hist(chimp_var_pval)

############## For humans

  human_var_pval &lt;- array(NA, dim = c(10304, 1))

  for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,human_begin_column_tm1:human_end_column_tm1])
    y &lt;- t(mean_tech_reps[i,human_begin_column_t:human_end_column_t])
    htest &lt;- var.test(x, y, alternative = c(&quot;less&quot;))
    human_var_pval[i,1] &lt;- htest$p.value
  }

  hist(human_var_pval)

############ Find p-values of the F_statistics

# Make one data frame

  var_pval &lt;- as.data.frame(cbind(chimp_var_pval, human_var_pval))
  rownames(var_pval) &lt;- rownames(mean_tech_reps)
  colnames(var_pval) &lt;- c(&quot;Chimpanzee&quot;, &quot;Human&quot;)
  summary(var_pval)

  dim(var_pval)

# Convert to data frame
  top_var_pval &lt;- var_pval[order(var_pval[,1]), ]
  
# Instead of going by p &lt; 0.05, take the top x number of p-values
  for_pi1_var_pval &lt;- array(NA, dim = c(10205, 2))
  
  for(i in 100:10304){
    num_var_pval &lt;- top_var_pval[1:i, 1:2]
  
# Get chimps
    num_var_pval_chimps_i &lt;- top_var_pval[1:i, 1]
  
# Get sharing
    num_var_pval_shared_i &lt;- top_var_pval[1:i, 2]
  

# Pi_0 estimate for the humans given significant in the chimps
  pi0est_humans_given_chimps_i &lt;- pi0est(num_var_pval_shared_i, lambda = seq(0.05, 0.95, 0.05))$pi0


# Pi_1 estimate for the humans
  for_pi1_var_pval[i-99,1] &lt;- i
  for_pi1_var_pval[i-99,2] &lt;- 1 - pi0est_humans_given_chimps_i
  }
  return(for_pi1_var_pval)
}

# Reduction in variance from day 0 to day 1

qqplot_red_top_all_day01 &lt;- find_qqplot_red_top_all(7,10,17,20,1,6,11,16)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction in variance from day 1 to day 2

qqplot_red_top_all_day12 &lt;- find_qqplot_red_top_all(17,20,27,30,11,16,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-3.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction in variance from day 2 to day 3

qqplot_red_top_all_day23 &lt;- find_qqplot_red_top_all(27,30,37,40,21,26,31,36)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-5.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-6.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Reduction in variance from day 0 to day 3

qqplot_red_top_all_day02 &lt;- find_qqplot_red_top_all(7,10,27,30,1,6,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-7.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-8.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 0 to day 1

qqplot_inc_top_all_day01 &lt;- find_qqplot_inc_top_all(7,10,17,20,1,6,11,16)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-9.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-10.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 1 to day 2

qqplot_inc_top_all_day12 &lt;- find_qqplot_inc_top_all(17,20,27,30,11,16,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-11.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-12.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 2 to day 3

qqplot_inc_top_all_day23 &lt;- find_qqplot_inc_top_all(27,30,37,40,21,26,31,36)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-13.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-14.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Inc. in variance from day 0 to day 2

qqplot_inc_top_all_day02 &lt;- find_qqplot_inc_top_all(7,10,27,30,1,6,21,26)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-15.png" width="672" style="display: block; margin: auto;" /><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-16.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Make everything a data frame
qqplot_red_top_all_day01 &lt;- as.data.frame(qqplot_red_top_all_day01)
qqplot_red_top_all_day12 &lt;- as.data.frame(qqplot_red_top_all_day12)
qqplot_red_top_all_day23 &lt;- as.data.frame(qqplot_red_top_all_day23)
qqplot_red_top_all_day02 &lt;- as.data.frame(qqplot_red_top_all_day02)
qqplot_inc_top_all_day01 &lt;- as.data.frame(qqplot_inc_top_all_day01)
qqplot_inc_top_all_day12 &lt;- as.data.frame(qqplot_inc_top_all_day12)
qqplot_inc_top_all_day23 &lt;- as.data.frame(qqplot_inc_top_all_day23)
qqplot_inc_top_all_day02 &lt;- as.data.frame(qqplot_inc_top_all_day02)

# Plots of pi_0

qqplot_red_top_all_day01_pi0 &lt;- abs(1- qqplot_red_top_all_day01)
qqplot_red_top_all_day12_pi0 &lt;- abs(1- qqplot_red_top_all_day12)
qqplot_red_top_all_day23_pi0 &lt;- abs(1- qqplot_red_top_all_day23)
qqplot_red_top_all_day02_pi0 &lt;- abs(1- qqplot_red_top_all_day02)
qqplot_inc_top_all_day01_pi0 &lt;- abs(1- qqplot_inc_top_all_day01)
qqplot_inc_top_all_day12_pi0 &lt;- abs(1- qqplot_inc_top_all_day12)
qqplot_inc_top_all_day23_pi0 &lt;- abs(1- qqplot_inc_top_all_day23)
qqplot_inc_top_all_day02_pi0 &lt;- abs(1- qqplot_inc_top_all_day02)

# Plots of pi_0

ggplot(qqplot_red_top_all_day01_pi0, aes(x = qqplot_red_top_all_day01_pi0[,1], y = qqplot_red_top_all_day01_pi0[,2])) + geom_line(colour=&quot;#E69F00&quot;) + theme_bw() + geom_line(aes(x = qqplot_red_top_all_day12_pi0[,1], y = qqplot_red_top_all_day12_pi0[,2]), colour = &quot;#000000&quot;) + geom_line(aes(x = qqplot_red_top_all_day23_pi0[,1], y = qqplot_red_top_all_day23_pi0[,2]), colour =  &quot;#009E73&quot;) + geom_line(aes(x = qqplot_red_top_all_day02_pi0[,1], y = qqplot_red_top_all_day02_pi0[,2]), colour =  &quot;#0072B2&quot;) + ylim(0,1) + ggtitle(expression( italic(hat(pi)[0]) ~ &quot;For Reduction in Variance Between Days (Humans|Significant in Chimpanzees)&quot; )) + xlab(&quot;N Most Significant Genes in Chimpanzees&quot;) + ylab(expression( italic(hat(pi)[0]) ~ &quot;(Humans|Significant in Chimpanzees)&quot;)) 

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = &quot;n&quot;, bty = &quot;n&quot;, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;)
legend(&quot;right&quot;, c(&quot;Day 0 to 1&quot;, &quot;Day 1 to 2&quot;, &quot;Day 2 to 3&quot;, &quot;Day 0 to 2&quot;), xpd = TRUE, horiz = FALSE, inset = c(0, 
    0), bty = &quot;n&quot;, pch = c(15, 15, 15, 15), col = c(&quot;#E69F00&quot;, &quot;#000000&quot;,  &quot;#009E73&quot;,&quot;#0072B2&quot; ), cex = 1)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-17.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(qqplot_inc_top_all_day01_pi0, aes(x = qqplot_inc_top_all_day01_pi0[,1], y = qqplot_inc_top_all_day01_pi0[,2])) + geom_line(colour=&quot;#E69F00&quot;) + theme_bw() + geom_line(aes(x = qqplot_inc_top_all_day12_pi0[,1], y = qqplot_inc_top_all_day12_pi0[,2]), colour = &quot;#000000&quot;) + geom_line(aes(x = qqplot_inc_top_all_day23_pi0[,1], y = qqplot_inc_top_all_day23_pi0[,2]), colour =  &quot;#009E73&quot;) + geom_line(aes(x = qqplot_inc_top_all_day02_pi0[,1], y = qqplot_inc_top_all_day02_pi0[,2]), colour =  &quot;#0072B2&quot;) + ylim(0,1) + ggtitle(expression( italic(hat(pi)[0]) ~ &quot;For Increase in Variance Between Days (Humans|Significant in Chimpanzees)&quot; )) + xlab(&quot;N Most Significant Genes in Chimpanzees&quot;) + ylab(expression( italic(hat(pi)[0]) ~ &quot;(Humans|Significant in Chimpanzees)&quot;)) 


par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = &quot;n&quot;, bty = &quot;n&quot;, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;)
legend(&quot;right&quot;, c(&quot;Day 0 to 1&quot;, &quot;Day 1 to 2&quot;, &quot;Day 2 to 3&quot;, &quot;Day 0 to 2&quot;), xpd = TRUE, horiz = FALSE, inset = c(0, 
    0), bty = &quot;n&quot;, pch = c(15, 15, 15, 15), col = c(&quot;#E69F00&quot;, &quot;#000000&quot;,  &quot;#009E73&quot;,&quot;#0072B2&quot; ), cex = 1)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-18.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Plots of pi_1

# Plot reduction in variation
ggplot(qqplot_red_top_all_day01, aes(x = qqplot_red_top_all_day01[,1], y = qqplot_red_top_all_day01[,2])) + geom_line(colour=&quot;#E69F00&quot;) + theme_bw() + geom_line(aes(x = qqplot_red_top_all_day12[,1], y = qqplot_red_top_all_day12[,2]), colour = &quot;#000000&quot;) + geom_line(aes(x = qqplot_red_top_all_day23[,1], y = qqplot_red_top_all_day23[,2]), colour =  &quot;#009E73&quot;) + geom_line(aes(x = qqplot_red_top_all_day02[,1], y = qqplot_red_top_all_day02[,2]), colour =  &quot;#0072B2&quot;) + ggtitle(expression( italic(hat(pi)[1]) ~ &quot;For Reduction in Variance Between Days (Humans|Significant in Chimpanzees)&quot; )) + xlab(&quot;N Most Significant Genes in Chimpanzees&quot;) + ylab(expression( italic(hat(pi)[1]) ~ &quot;(Humans|Significant in Chimpanzees)&quot;)) 

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = &quot;n&quot;, bty = &quot;n&quot;, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;)
legend(&quot;right&quot;, c(&quot;Day 0 to 1&quot;, &quot;Day 1 to 2&quot;, &quot;Day 2 to 3&quot;, &quot;Day 0 to 2&quot;), xpd = TRUE, horiz = FALSE, inset = c(0, 
    0), bty = &quot;n&quot;, pch = c(15, 15, 15, 15), col = c(&quot;#E69F00&quot;, &quot;#000000&quot;,  &quot;#009E73&quot;,&quot;#0072B2&quot; ), cex = 1)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-19.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Plot inc in variation
ggplot(qqplot_inc_top_all_day01, aes(x = qqplot_inc_top_all_day01[,1], y = qqplot_inc_top_all_day01[,2])) + geom_line(colour=&quot;#E69F00&quot;) + theme_bw() + geom_line(aes(x = qqplot_inc_top_all_day12[,1], y = qqplot_inc_top_all_day12[,2]), colour = &quot;#000000&quot;) + geom_line(aes(x = qqplot_inc_top_all_day23[,1], y = qqplot_inc_top_all_day23[,2]), colour =  &quot;#009E73&quot;) + geom_line(aes(x = qqplot_inc_top_all_day02[,1], y = qqplot_inc_top_all_day02[,2]), colour =  &quot;#0072B2&quot;) + ggtitle(expression( italic(hat(pi)[1]) ~ &quot;For Increase in Variance Between Days (Humans|Significant in Chimpanzees)&quot; )) + xlab(&quot;N Most Significant Genes in Chimpanzees&quot;) + ylab(expression( italic(hat(pi)[1]) ~ &quot;(Humans|Significant in Chimpanzees)&quot;)) 

par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = &quot;n&quot;, bty = &quot;n&quot;, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;)
legend(&quot;right&quot;, c(&quot;Day 0 to 1&quot;, &quot;Day 1 to 2&quot;, &quot;Day 2 to 3&quot;, &quot;Day 0 to 2&quot;), xpd = TRUE, horiz = FALSE, inset = c(0, 
    0), bty = &quot;n&quot;, pch = c(15, 15, 15, 15), col = c(&quot;#E69F00&quot;, &quot;#000000&quot;,  &quot;#009E73&quot;,&quot;#0072B2&quot; ), cex = 1)</code></pre>
<p><img src="figure/Temporal_changes_variation.Rmd/unnamed-chunk-13-20.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="for-bryan-to-test-clusters" class="section level3">
<h3>For Bryan to test clusters</h3>
<pre class="r"><code># Reduction Day 0 to 1 chimps

chimp_var_pval &lt;- array(NA, dim = c(10304, 1))

for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,7:10])
    y &lt;- t(mean_tech_reps[i,17:20])
    htest &lt;- var.test(x, y, alternative = c(&quot;greater&quot;))
    chimp_var_pval[i,1] &lt;- htest$p.value
}
rownames(chimp_var_pval) &lt;- rownames(mean_tech_reps)
length(which(chimp_var_pval &lt; 0.05))</code></pre>
<pre><code>[1] 612</code></pre>
<pre class="r"><code>chimp_red_01 &lt;- as.data.frame(chimp_var_pval[which(chimp_var_pval &lt; 0.05), ])
dim(chimp_red_01)</code></pre>
<pre><code>[1] 612   1</code></pre>
<pre class="r"><code>write.table(chimp_red_01,file=&quot;~/Desktop/Endoderm_TC/ashlar-trial/data/red_chimps_day0_1.txt&quot;,sep=&quot;\t&quot;, col.names = T, row.names = T)


# Reduction Day 0 to 1 humans
human_var_pval &lt;- array(NA, dim = c(10304, 1))

for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,1:6])
    y &lt;- t(mean_tech_reps[i,11:16])
    htest &lt;- var.test(x, y, alternative = c(&quot;greater&quot;))
    human_var_pval[i,1] &lt;- htest$p.value
}
rownames(human_var_pval) &lt;- rownames(mean_tech_reps)
length(which(human_var_pval &lt; 0.05))</code></pre>
<pre><code>[1] 2289</code></pre>
<pre class="r"><code>human_red_01 &lt;- as.data.frame(human_var_pval[which(human_var_pval &lt; 0.05), ])
dim(human_red_01)</code></pre>
<pre><code>[1] 2289    1</code></pre>
<pre class="r"><code>write.table(human_red_01,file=&quot;~/Desktop/Endoderm_TC/ashlar-trial/data/red_human_day0_1.txt&quot;,sep=&quot;\t&quot;, col.names = T, row.names = T)


# Increase Day 1 to 2 chimps
chimp_var_pval &lt;- array(NA, dim = c(10304, 1))

for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,17:20])
    y &lt;- t(mean_tech_reps[i,27:30])
    htest &lt;- var.test(x, y, alternative = c(&quot;less&quot;))
    chimp_var_pval[i,1] &lt;- htest$p.value
}
rownames(chimp_var_pval) &lt;- rownames(mean_tech_reps)
length(which(chimp_var_pval &lt; 0.05))</code></pre>
<pre><code>[1] 531</code></pre>
<pre class="r"><code>chimp_inc_12 &lt;- as.data.frame(chimp_var_pval[which(chimp_var_pval &lt; 0.05), ])
dim(chimp_inc_12)</code></pre>
<pre><code>[1] 531   1</code></pre>
<pre class="r"><code>write.table(chimp_inc_12,file=&quot;~/Desktop/Endoderm_TC/ashlar-trial/data/inc_chimps_day1_2.txt&quot;,sep=&quot;\t&quot;, col.names = T, row.names = T)


# Increase Day 1 to 2 humans
human_var_pval &lt;- array(NA, dim = c(10304, 1))

for(i in 1:10304){
    x &lt;- t(mean_tech_reps[i,11:16])
    y &lt;- t(mean_tech_reps[i,21:26])
    htest &lt;- var.test(x, y, alternative = c(&quot;less&quot;))
    human_var_pval[i,1] &lt;- htest$p.value
}
rownames(human_var_pval) &lt;- rownames(mean_tech_reps)
length(which(human_var_pval &lt; 0.05))</code></pre>
<pre><code>[1] 2043</code></pre>
<pre class="r"><code>human_inc_12 &lt;- as.data.frame(human_var_pval[which(human_var_pval &lt; 0.05), ])
dim(human_inc_12)</code></pre>
<pre><code>[1] 2043    1</code></pre>
<pre class="r"><code>write.table(human_inc_12,file=&quot;~/Desktop/Endoderm_TC/ashlar-trial/data/inc_human_day1_2.txt&quot;,sep=&quot;\t&quot;, col.names = T, row.names = T)</code></pre>
</div>
</div>
</div>


<!-- some extra javascript for older browsers -->
<script type="text/javascript" src="libs/polyfill.js"></script>

<script>

// manage active state of menu based on current page
$(document).ready(function () {

    // active menu
    href = window.location.pathname
    href = href.substr(href.lastIndexOf('/') + 1)
    $('a[href="' + href + '"]').parent().addClass('active');

    // manage active menu header
    if (href.startsWith('authoring_'))
      $('a[href="' + 'authoring' + '"]').parent().addClass('active');
    else if (href.endsWith('_format.html'))
      $('a[href="' + 'formats' + '"]').parent().addClass('active');
    else if (href.startsWith('developer_'))
      $('a[href="' + 'developer' + '"]').parent().addClass('active');

});

</script>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

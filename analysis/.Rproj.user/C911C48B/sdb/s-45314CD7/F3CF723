{
    "contents" : "---\ntitle: \"Use PCA to visualize single-cell data\"\nauthor: \"Joyce Hsiao\"\ndate: 2015-12-12\n---\n\n**Last updated:** `r Sys.Date()`\n\n**Code version:** `r system(\"git log -1 --format='%H'\", intern = TRUE)`\n\n```{r chunk-options, include=FALSE}\nsource(\"chunk-options.R\")\n```\n\n## Objectives\n\nWe import data collected in [singleCellSeq][] and visualize the data using principal component analysis. The PCA code was created by [John Blischak][JB] and are stored in *ashlar/codes*. \n\n[singleCellSeq]: http://jdblischak.github.io/singleCellSeq/analysis\n[JB]: http://jdblischak.github.io\n\nPCA visualization was performed to inspect the first two major sources of variation. Do cells come from different individuals share similar variation? Do cells come from different batches share similar variation? \n\n\n## Prepare data\n\nImport gene by sample (cell) matrix. Each column consists of molecule counts of a single cell. \n\n```{r}\nmolecule_final <- read.table(\"../data/molecules-final.txt\",\n                             header = TRUE, \n                             sep = \"\\t\",\n                             stringsAsFactors = FALSE,\n                             row.names = 1)\n```\n\nImport metadata information. This annotates for every cell the individual (cell line) labels, replicate labels, etc. \n\n```{r}\nannotation_filter <- read.table(\"../data/annotation-filter.txt\",\n                                header = TRUE,\n                                sep = \"\\t\",\n                                stringsAsFactors = FALSE)\n```\n\n\n## Making PCA plots\n\nSource PCA functions.\n\n```{r}\nsource(\"../code/functions.R\")\n```\n\nRun PCA.\n\n```{r}\npca_results <- run_pca(as.matrix(molecule_final))\n```\n\nVisualize PCA results.\n\n```{r}\nplot_pca(pca_results$PCs,\n         explained = pca_results$explained,\n         metadata = annotation_filter,\n         color = \"individual\",\n         shape = \"batch\") +\n  labs(title = \"Molecules (log2 cpm) for single cells\")\n```\n\n\n\n## Session information\n\n```{r info}\nsessionInfo()\n```\n",
    "created" : 1449903490811.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2362618374",
    "id" : "F3CF723",
    "lastKnownWriteTime" : 1449906004,
    "path" : "~/Dropbox/GitHub/ashlar/analysis/single-cell-pca.Rmd",
    "project_path" : "single-cell-pca.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}